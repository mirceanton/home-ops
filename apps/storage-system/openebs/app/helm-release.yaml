---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: openebs
spec:
  interval: 10m
  chartRef:
    kind: OCIRepository
    name: openebs

  values:
    localpv-provisioner:
      localpv: {enabled: false}
      hostpathClass: { enabled: false }
      analytics: { enabled: false }

    zfs-localpv:
      resources: {}
      zfsController:
        replicas: 1
        resources: {}

    # ====================================================================
    # ====================== Disable EVERYTHING Else =====================
    # ====================================================================
    analytics: {enabled: false}
    alloy: {enabled: false}
    loki: {enabled: false}
    engines:
      local:
        zfs: {enabled: true}
        lvm: {enabled: false}
        rawfile: {enabled: false}
      replicated:
        mayastor: {enabled: false}
    openebs-crds:
      csi:
        volumeSnapshots:
          enabled: false  # CRDs deployed by snapshot-controller
          keep: false
