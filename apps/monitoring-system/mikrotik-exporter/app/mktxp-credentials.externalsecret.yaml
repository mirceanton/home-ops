---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mktxp-credentials
spec:
  refreshInterval: 1h

  secretStoreRef:
    name: onepassword
    kind: ClusterSecretStore

  target:
    name: mktxp-credentials
    creationPolicy: Owner
    template:
      engineVersion: v2
      data:
        rb5009.yaml: |
          username: {{ .rb5009_username }}
          password: {{ .rb5009_password }}
        crs317.yaml: |
          username: {{ .crs317_username }}
          password: {{ .crs317_password }}
        crs326.yaml: |
          username: {{ .crs326_username }}
          password: {{ .crs326_password }}
        hex.yaml: |
          username: {{ .hex_username }}
          password: {{ .hex_password }}

  data:
    - secretKey: rb5009_username
      remoteRef:
        key: RB5009 - metrics
        property: username
    - secretKey: rb5009_password
      remoteRef:
        key: RB5009 - metrics
        property: password
    - secretKey: crs317_username
      remoteRef:
        key: CRS317 - metrics
        property: username
    - secretKey: crs317_password
      remoteRef:
        key: CRS317 - metrics
        property: password
    - secretKey: crs326_username
      remoteRef:
        key: CRS326 - metrics
        property: username
    - secretKey: crs326_password
      remoteRef:
        key: CRS326 - metrics
        property: password
    - secretKey: hex_username
      remoteRef:
        key: HEX - metrics
        property: username
    - secretKey: hex_password
      remoteRef:
        key: HEX - metrics
        property: password
