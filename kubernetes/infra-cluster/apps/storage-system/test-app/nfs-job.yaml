---
apiVersion: batch/v1
kind: Job
metadata:
  name: fio-job-nfs
spec:
  template:
    spec:
      restartPolicy: Never
      volumes:
        - name: test-volume
          nfs:
            server: 10.0.10.245
            path: /mnt/tank/Homelab/InfraCluster/minio
          persistentVolumeClaim:
            claimName: test-volume-claim
      containers:
        - name: fio
          image: nixery.dev/shell/fio
          args:
            - fio
            - --name=benchtest
            - --size=800m
            - --filename=/volume/test
            - --direct=1
            - --rw=randrw
            - --ioengine=libaio
            - --bs=4k
            - --iodepth=16
            - --numjobs=8
            - --time_based
            - --runtime=60
          volumeMounts:
            - mountPath: "/volume"
              name: test-volume
