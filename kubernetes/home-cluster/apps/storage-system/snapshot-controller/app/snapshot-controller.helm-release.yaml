---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: snapshot-controller
spec:
  chart:
    spec:
      chart: snapshot-controller
      version: 0.2.4
      sourceRef:
        kind: HelmRepository
        name: democratic-csi

  values:
    imagePullSecrets: []


    ## ================================================================================================
    ## CONTROLLER DEPLOYMENT PARAMETERS
    ## ================================================================================================
    controller:
      enabled: true
      replicaCount: 3

      image:
        repository: registry.k8s.io/sig-storage/snapshot-controller
        pullPolicy: IfNotPresent

      args:
      - "--v=5"
      - "--leader-election=true"
      - "--enable-distributed-snapshotting"

      rbac:
        enabled: true


    ## ================================================================================================
    ## VALIDATING WEBHOOK PARAMETERS
    ## ================================================================================================
    validatingWebhook:
      enabled: false
      replicaCount: 3

      image:
        repository: registry.k8s.io/sig-storage/snapshot-validation-webhook
        pullPolicy: IfNotPresent

      rbac:
        enabled: true
