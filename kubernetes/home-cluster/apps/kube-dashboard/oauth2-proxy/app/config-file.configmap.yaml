---
apiVersion: v1
kind: ConfigMap
metadata:
  name: oauth2-proxy-configfile
data:
  oauth2_proxy.cfg: |
    provider = "keycloak-oidc"
    provider_display_name = "Keycloak"

    reverse_proxy = "true"
    scope = "openid"

    oidc_issuer_url = "https://auth.${CLUSTER_DOMAIN}/keycloak/realms/home"
    redirect_url = "https://kube-dashboard.${CLUSTER_DOMAIN}/oauth2/callback"
    code_challenge_method = "S256"
    email_domains = [ "*" ]

    whitelist_domains = [ ".mirceanton.com", "mirceanton.com", ".mirceaanton.com", ".mirceaanton.com" ]
    cookie_domains = [ ".mirceanton.com", "mirceanton.com", ".mirceaanton.com", ".mirceaanton.com" ]
    cookie_name = "_oauth2_proxy"
    cookie_refresh = "1m"
    cookie_csrf_expire = "5m"
    cookie_expire = "0"
    cookie_samesite = "lax"
    cookie_csrf_per_request = "true"
    cookie_secure = "false"

    pass_access_token = "true"
    pass_authorization_header = "true"
    pass_user_headers = "true"
    set_xauthrequest = "true"
    set_authorization_header = "true"
    real_client_ip_header = "X-Forwarded-For"

    silence_ping_logging = "true"
