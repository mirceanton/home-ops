---
# yaml-language-server: $schema=https://raw.githubusercontent.com/fluxcd-community/flux2-schemas/main/helmrelease-helm-v2beta1.json
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
name: ci-ansible_role-proxmox_vfio-runners
spec:
chart:
    spec:
    chart: gha-runner-scale-set
    version: 0.6.1
    sourceRef:
        kind: HelmRepository
        name: actions-runner-controller

interval: 30m
maxHistory: 2
install:
    remediation:
    retries: 3
upgrade:
    cleanupOnFail: true
    remediation:
    retries: 3
uninstall:
    keepHistory: false

dependsOn:
    - name: cluster-apps-github-actions-controller
    namespace: github-actions

values:
    runnerScaleSetName: self-hosted
    minRunners: 1
    maxRunners: 10

    githubConfigUrl: https://github.com/mirceanton/ansible_role-proxmox_cloudbuntu
    githubConfigSecret: github-actions-runner-token

    containerMode:
    type: dind
