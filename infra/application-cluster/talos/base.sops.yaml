# Indicates the schema used to decode the contents.
version: v1alpha1
# Enable verbose logging to the console.
debug: false
# Indicates whether to pull the machine config upon every boot.
persist: true
# Provides machine specific configuration options.
machine:
    # The `token` is used by a machine to join the PKI of the cluster.
    token: ENC[AES256_GCM,data:k/nJ1KGFyVm473nARhmFiRRvJW6i8GE=,iv:ol3Tg+pHbxOITuynJrbx/+fK1MmubErbnbAORhSsOyg=,tag:kChPnQ6N2Jzib0zWzPFs7Q==,type:str]
    # The root certificate authority of the PKI.
    ca:
        crt: ENC[AES256_GCM,data:Q7C5HjKHA5g/xaUSWHG5aBpEVy3NIXSAuxO6eDxwUzhlD5Pp9Xd1f78/kh5HffhOfrTqkvo6cX1F0P/raoG9G8fIaebq8IJEOi/SQiAtdU+AfL8yGHbAyyLV5dQ+jAxWncL+yQbdvVGbcsbc5oPUIJc1jaqjbOvqq9z2xcgDloH6ekkNQ/dpH/Pnt8gn2p/Sn4UBI0OC7gNfSVbMxWvCxysWM4vFTo3XZz1HPUKeqo790RGn4fmXTuj5b54trgUUh2DQl/wO/LT0E69vS8gosH9Fw4TRjPRullvNkMFgms1Rs8ztfQKcFWII7S33x/i21ESLsjl0ZliKajN7MOvfPO7fNvBamhBW5gJXVzjU/MlHA+sv/PDMT02+1BPWg2aFPYVTuruRENbYE6gK6dtM5Ngi9q4sJ+zWFQ6pK4jzX1WdRTxg0Hs5K6RF7AzWNI8sxpraP0QWDtDe1hTg9UWew2CjveYFc1St8peo1qvU5XYbIN7/S4Yu9pBPtAhsCetF5LkHkAr/Kz5bMZ61RHme1kDFyqOMEVRhv0qOs14iCFlvQ0dQdQsPNLn9Jo4Bg0gaN1u9VOSZZzb5XZlBX0b/yRZzYv8ryl1Y9jU7eoTGEVFuM9jzcS3iVOkUFdrLw16FvmjaX9P2MKTpKyrQgEB2mk9libMep2k0qEpgqTgFbHuCyrTRvcsSNb8fza+BpeB4Z6RkwEfFXF159pw4l+ZP5kZMp6F8FVb4cO/xVwkOFRmEVnkhjIb/iOeud8NpAL4gTiov9AdVm8QufPIiAi7Z+ynI8dhIaEOl+auSBUbZvdq0f7EubR9hNlHnTPidNhPBfrn05t08b+H0zeTupx9Ep2bx/qOAXR8dDZF3CYthA5S7Vnbk,iv:PcopRq/cobex6U3gtWp9YgfHLKAkfNazMW7nGDTR7Sg=,tag:1Ik/y1tyT4VG0zT0eyuabg==,type:str]
        key: ENC[AES256_GCM,data:DezH3L3okfBxMHloTNdYMHLHt34i/rjDNn7npGUuYAMxE2fivHNzpXfMoeXXpK0wua9Og75mBL3z8AmO3zy7keTf8zw8kWwO2PDRiBQS9Uq6mzq058EyyWwOU4J0VS4/SZCn+q+igwZ6+InqP4J8HgxMCG2XP+lLF9eN4Ao5gLCxj5v0sIyLFXJnA99pCe1iPpQ4i+K/2fBg0+2gdzObhoXTPOV3epKy/mQIHaSfhEwHOFzX,iv:aYeUzZ60jpjm2vTlpkoIf0UpUmjMpjA87+4h8QRDVbk=,tag:PyjJJtDyVtUKg7f5OvjvTg==,type:str]
    # Extra certificate subject alternative names for the machine's certificate.
    certSANs: []
    # Used to provide additional options to the kubelet.
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.27.1
        defaultRuntimeSeccompProfileEnabled: false
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
        extraMounts:
            - destination: /var/local
              source: /var/local
              type: bind
              options:
                - rbind
                - rshared
                - rw
    # Provides machine specific network configuration options.
    network:
        interfaces:
            - interface: eth0
              routes:
                - network: 0.0.0.0/0
                  gateway: 10.0.69.1
        # Used to statically set the nameservers for the machine.
        nameservers:
            - 10.0.69.1
        # Allows for extra entries to be added to the `/etc/hosts` file
        extraHostEntries:
            - ip: 10.0.69.11
              aliases:
                - akc-01
            - ip: 10.0.69.12
              aliases:
                - akc-02
            - ip: 10.0.69.13
              aliases:
                - akc-03
    # Used to provide instructions for installations.
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.4.5
        # Indicates if a bootloader should be installed.
        bootloader: true
        # Indicates if the installation disk should be wiped at installation time.
        wipe: false
        # # Allows for supplying additional system extension images to install on top of base Talos image.
        # extensions:
        #     - image: ghcr.io/siderolabs/gvisor:20220117.0-v1.0.0 # System extension image.
    # Allows the addition of user specified files.
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    # Used to configure the machine's time settings.
    time:
        disabled: false
        servers:
            - time.cloudflare.com
    sysctls:
        vm.nr_hugepages: "1024"
    # Features describe individual Talos features that can be switched on or off.
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
# Provides cluster specific configuration options.
cluster:
    allowSchedulingOnControlPlanes: true
    clusterName: application-cluster
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    id: ENC[AES256_GCM,data:3YquJAJACvDQfB5fy9kemNG5bA+66a/OlwYaFBeXIcsjux4tH/5ikQMbiyA=,iv:a2dTCplW5l8L8v4MqLwTHwEF4XkLpjxKMC/jayAzFOU=,tag:eXfwNdPOvSU7w7S2lcNFAg==,type:str]
    # Shared secret of cluster (base64 encoded random 32 bytes).
    secret: ENC[AES256_GCM,data:wtlsNc55Vmws2Dhs25+YtTdsVnJYYyge8kd64xiowVILhLm7+jMpnXFNn/k=,iv:bwshKKfrbn4JpuigQW7kr4NiUnYBPUNBVx9L0hTf30A=,tag:Y3afAQjvdJ72XGPoRq9DXA==,type:str]
    # Provides control plane specific configuration options.
    controlPlane:
        # Endpoint is the canonical controlplane endpoint, which can be an IP address or a DNS hostname.
        endpoint: https://10.0.69.10:6443
    # Provides cluster specific network configuration options.
    network:
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.25.1/manifests/calico.yaml
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    token: ENC[AES256_GCM,data:YhMkVJ+g6Qsg70Pv9tc6CSqHNBLrL/g=,iv:tnYlHsI+u/I8EMatQmxZxvOxoTj3/idlaOfiGc2AdpE=,tag:8+0s8OS500VtvukELB1lNA==,type:str]
    # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).
    secretboxEncryptionSecret: BAL1nSFjDaNrIl80a/6PLGZOk0G1NLu0bQdmaQ2k0RE=
    # The base64 encoded root certificate authority used by Kubernetes.
    ca:
        crt: ENC[AES256_GCM,data:VLLpb9Ml1doKs4+F8rBKCpUPBwu6Re5M3nBDHMMqlr0U+6etwT7VPbkMAf9upi6bBlarxdM7xciJLkTk1oSdPba0fy1i1BQHU0YxNns7f/jUMK8qHi0VwKV8G45QOQC2efqx3pFN7vf0NTxJ17jrT0lSoX4XMGAQVAzaDS3bpxzLdO2DXC7nosKzr/bAW/1n+gUTsLzHpTzD/Xbosk/AG1QF3rYd1cuCX3/jkkZMxKmPUL9gMty5QpJMnB39IYqmYPXpVQDCzm7ioqmG7IRWhllKGeBoqu5hS/gp4dMjWI6YSppFK0jyqHi92oJvThdrvj2rU3K/BzXArcbqbFpPYmtzipO/42WCphzNWgn9IE6HrT6Jj1PmKa2A3LI+3czr2BsKmQiK18nYL90QLBBhY5tREzYcUNkDyvKYoAVbG5GlxwtGX+/tES9fex4UnvE+lvQ2VeJ3jnJFtozNq2yaWkiKqMUpST3EovhILcex31rZYvpKx1bZuOsfapEpiuDY2pDFYyZYi8KLyE3qbSy6pjD+9LfmzBzmZlFHunTne0z08hqFwYCv/EKXFBrxGcPDIU2wZqRI8zQ6clnYWM6jkMEIpkdZDJ2edeYKf49K0gH/9EpRsD3fYDUp5v7E7EAA24KYzEK0fX01V8DyHYixVc2Q9ezzbDcgb15rylkAz8+MC5IEYuVJWTluUJp+UJ2wPKH9nN3iBmLgAHuyi8d36t7/Yl+4SY08WWIKK3EstP9J1YnQmtGDLXVpg7JOvU+S0QsCiX++qrYmNyrXkaGHblfN5ricRweHSnddl8iCkt67iZAjIpl2Z5MkHqvwlHSTEf0B+E2i2vJzKxSH3f4NONEOCmh8SVfyZEH7pocVyjb2yy7lxjJhTwxIEfHbGFJf4uP58Rv7mZMskwnN473L+rqET3+HTNQuVNvkEgibSiGYLB4m3y0aQZQL03pKCFYu+y3ou62A6OhpVetHjBzL6h5a1p+bCaRhRnbNTtixW98c7+kgFO6JOdwWvmfPdp3TMK7QSbb+ikb/Mco8W0lCMLuYnOiCoUBnzdto9w==,iv:R8evY5CrNkkOK1RkLlj0SssbCJpnxM1tqLc/qF6YR1Q=,tag:rfy5+MnJds/BtqaTt1LMyQ==,type:str]
        key: ENC[AES256_GCM,data:3GL3iierIXjIdKP0wpVvjqg83Svx2+nuqwg4wGvVmkzyTFwS1zmmBZTf0IAfdg/X/IYzbuH+ERS6j3TE5Q09ba44RAXX81qxVOGAHitd2AHyk5e38KegFOoR8JJh1b2TmgsavIqrSrrcAUQMj/FDRnNvJoFtwduWL4PGcafyIgYRBegowbPn0qJHvhhhc5sNn5SXpvXsjvpCD7Bd9F+Vg2WS4ZpXv+2E11zdQGqMsSlq6+jOo3hfYtaFFJnjzfo30qnY3xXgodYFadHijl4NDHL9U30wPtWL07AEO+10TM6jbv8pu5mI+Q2yjEO1pUIp/WeQCS4E05R4k/pJNjKDaKNn1VfCkNHHLZrt8429+R1NI07HBuUvKmUR6Y1XrzK6tAEdKRsVtheqMLp+NOoVrA==,iv:/FBUw4SNPLtA5ESeYgOD6kPX13IHQzmyQqJMcJJlOKs=,tag:4uyWrz7paA3bkq+yLwvnKQ==,type:str]
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    aggregatorCA:
        crt: ENC[AES256_GCM,data:Y8sM7r92zUtVAHXX0QmE8cJs766YUQkxTJkG8Wsk0lT160XbdtawW4+EDrbQ0g39raig1n84UYoUnirqCuuB7d3XYxGzSY30bhaPD6nd6jMt+xPts4pM4usvnlJUx2sMON8TBL9TpsuoXir4GqCQ+9HAQ1Phl6duCImA9OMqcvnDncP6Xp6VK+UnvlhhD2hoQKpvstk4G4EBy3zxneCKypP820bRB9IcUEU/UJ1qheUI8vVdpGlhgLwv9+CKu5TqExLqDS5aaePsw2rz0gYtDasLL3oHu7umw3/uCMUb7Y/o+7p/N0q9VO2suiGRpv1ehdxuE5Xpq78ufcaa/SK+t22qWxxgjfj2sJSjXLrLVNEGKfm6oGnHxmU3CLxfgcYECD6xSpWzd75M2gOZzvn8eCJqAl99JPV6WW2XCZ9LQm87AT1QaeZyphC+dQVsfwSE3bnXQwrKi3EV/p0NhJ3Fbyvp8/tk0w1/4dJki6uM55JymXDE5ALVy0a1n2MMrAF9xetpvWrM/SZELsT4W75mdYOjNYdH6bJM0GU+2lTq7Ra55d615U1mxFyGkGeetZpz04DeRqmo2n5eBppy1oyzV7O5cYwj8AmM+kxrOdB9vIWhJu40MaL5RGwS7fntZHL2NdxoXk/i2K5vLxaw8X50Y+EdhyWjOjCBYWpnmQxmiJAWwcEtnuzBf0S5URtGEZkTRzuAYWGXdMkfhJ+71CBHdro9kK2kptY4tj734WLzwvNYzaFdybRwDoRvLjDawFsWkzt0jptG1DpFePylOnyTEYNpPz0hmfAWPtp7Llj+E3km9Di0f2L7pOxxryKmFF00tk2GyCIwiG7gnraTFPopKeOY1lJ8GSO4vIvYedOZ0dzVpqVVVMfYEUTTOyzESaM95UaGpr/fxkVUpO/BQ4lgSg6w0JtnVZsdTpFtR31zD2P+NkwmXbnqsP9M+O52ITXR,iv:PWo0V6BAeZHxNrL0yV8+jcxcTI+HK/YiLNpmd7k2HzY=,tag:MFq7xMN8NtBoyeU7eTt3uQ==,type:str]
        key: ENC[AES256_GCM,data:8hdibEZUD2YUcGIB1GynTaIBl67NFo1/RL2pY9enEC2I0HFDY2oQG/RWpdy4VXos5KvS5iE/0Tu1Kwq5ezmPAglSSiF/2w88nZ8JaQn6NStpqiWDmbYxFo6fWRxEFNzsN4Qs2Ds/1e6xA95VP+wTlu4jm/60GrXqFtV0q33lKFFNZC2oFJjili4QqpdaYVAT0p4BO0TEDWpXzZQxx8Q/zdXsZAGs5CdKFRDfrD0MbbRneDxJu6bvnTqp21vFYLEz4tvsA6g6rbA8Ao/vIMZthlymJRmkjhAKODKf4xQq+I2xu0ABTPWdij6qDInBbf50QLem9vFXF6PhiAdTn1QP98DI2QBI7/jbYuKSrc5/4TJgFMwNpygbqih28brQTKtP/wOh0qhWt0VqDxYhBkOD2Q==,iv:5JHb4j4vwFHA0ySloVILsXzOfIuIOGcXNrQ3xYBHvYU=,tag:tfe9vpv9usYPWh8mm62OFw==,type:str]
    # The base64 encoded private key for service account token generation.
    serviceAccount:
        key: ENC[AES256_GCM,data:LO8x31KCn3VfuMsL7t6cf/KP2wSv0yTKYMKfoyR/1C2BlTGqJ1y3RGJ6f6Z/yBy0w4P5lateFVC85eZpjBreDbZpPy/qzwG9JidWGspHP0irm705AbuNndYHszFXo4iP6JNLK6wVBOz6mQ7gQzp8Pd2Qtiko53v+JqsS+qFxUpuTanHRKASf+DZC/d1VYbv4tqSvTDUSnczIXEr9a75eDD0yLu9viY/fUZlUVOgMWLT8s69Jb8Ht8p14br0LTddlSEMBUgrR2PpG3PNeOpatwzXxVyPFB3QBECAnPBdYMc3x+6LyaGNiZazPexdxrKqT1cARWhjHfhPTJGdAoRAHQY8DhQAhIyaWgYCwCxeABK5w4xtoNQwvKAWUv3R8AhiVMqlwbVC0Q1XenMJLz6gAjA==,iv:w4H6PXpWyLDxo9DZ10thS8JQ3tIwaDD/I2zeq4dpA9g=,tag:XE5FTj+8WGU2ZaR2tF/YmA==,type:str]
    # API server specific configuration options.
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.27.2
        certSANs:
            - 10.0.69.10
        disablePodSecurityPolicy: true
        # Configure the API server admission plugins.
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: restricted
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: restricted
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    # Controller manager server specific configuration options.
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.27.2
    # Kube-proxy server-specific configuration options
    proxy:
        image: registry.k8s.io/kube-proxy:v1.27.2
    # Scheduler server specific configuration options.
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.27.2
    # Configures cluster member discovery.
    discovery:
        enabled: true
        # Configure registries used for cluster member discovery.
        registries:
            kubernetes:
                disabled: true
    # Etcd specific configuration options.
    etcd:
        image: gcr.io/etcd-development/etcd:v3.5.9
        # The `ca` is the root certificate authority of the PKI.
        ca:
            crt: ENC[AES256_GCM,data:brcE6Vo07burbRG8J9ZCT1ZntDRvHsGwyBFhDExW0SIO63b1gb85XTw8zev6taej7E6iFNcruQxZR/bctRlU5BF2Sjg2/7n3XDEUJGHJBuT0j6HClivvJwe+2MmGaPlwQz2IvtwuJvjJYjOO7puekzRLYAqlzmxTnZ87hK/MpNePCvmmtDI5LgAR9c98qCjSTZBzMnifIEs9N/ikfDzLskOQFNjViFOMyKKMBVs+fIWt9DighpMfhvk8XyC/bKOF616/BtisoKtG2UFiuIVgx6lXhlbHrykDBtD4UPauf3TgPpnFKeaTAhR4xVv4jroLPUgBlefntbXq/gpLn0H0HPg4nAD3Iw7nOy54N2y37GrgO/O56vYoQ7gGr/4px+hWXSUH6fkjEr+ENWFxL3HsjAQBVc9v1twVYMxPd8SNXAWfZ8pScIwQaEZYHPEo9oGbdz+8FLXaYHHwCpLb1baOBq+tqt5jAyZvJC6KKS9QNU2JloLUXLIbYbYTDZMpgf6l5XXT9HzHDlrhMUa8gep+fIx7RXTRx2LLQ2V3w7X2RpxOe4/PIkBBJhoail+QaDrvijCsKo8VdXZSNdldymKVNhqZLZ3vhLwXh1VoW4QbZQNp8Aa4jwBJFiZMkpBGmvRuRN+JuBag4BR+0rDsHg4QJQ59jYJaTLqhz++wkoVR53T8xvY9wl1/e/ckFQ0ft77dicM9mGTBw+fVButZe1uXOJXE/Vf88/8JuxeI5AmW8+GEQ81vVtjjUj5qyRozpfwNbNaFd0+kjj6EPG0Pha2YHtNO7WaE3qJ+m0E2XXvLWCTW43kgqRcIAkMGAl3hTIjMTs86NGCkDsm9/F0grF/Kq5194s6IAcgVjMGjTo2g2jU3Q0/0lIZB7AH0OrN6JE2n5QNRtiPsfWhHbqzndgT3J7l2K/N8+k3RL3mP5jbg5IrvxZJyWb5QSXM8fPV2t6CQnm/sjJSYQjmhH41Cq9FpBRuaxAr/2/od7Dutu7l6+il1MowQHZq/OmaBRPFjMYt+8k7Ozw==,iv:B3oGzDnPC71FWWw1IQfN2pb9JyjYDO6ZNwQcupwvMgU=,tag:191APU0C8khDy9HqkG0/Cg==,type:str]
            key: ENC[AES256_GCM,data:yVNQzFHlDw+xcMqh5AYswTMgVnSnWCpw+zAIOCES3GS1OfBZRJAYDlJaRfFUJX2UccUI3Fxg9XKWOSbFGRmaCfjaiqiRooz52p0f9vn5uFMCwoD7OPW0/OBMmm/ZE+UBuJQETFr8lEa3jB1mnNfvZLgLC6/SWZtL9XfAlIy73oY4meVlT4/3gQ49gAc/CWVg0nZh5NBSObHA2q9BOpve2SRaxB0sisxaYzbd67LhYABjqfhXumxdv5evvu+MbKWhy0/7p5ELP08BBCvYGq/PEvgyJkYSLDLHck6GQ6EzUIu0II0bIhk+IxK1A8g/WvUrzF8geqgz0i64dDIlNNv0So3coTtWLA4tLW6MbbYPYtSCCwkNyeF/HEBh8SiFnPaV8aqjoxKvS8aQ85Vhj25BSg==,iv:oli/icF7lIeWUIyZfDgU/k1GEdjnJkjO2xFuhEjGsRo=,tag:szaKX7a0NZfRbySMHkjmGA==,type:str]
    # A list of urls that point to additional manifests.
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
        - https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
    # A list of inline Kubernetes manifests.
    inlineManifests: []
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB1TnNCY0pOTHRTZHJtWW5K
            VGdZVnhEU1RDbGlhTTJZblRNL3JMcGZ6RkQwCnVyZEZCS3Y2d2ZTbDVxS1V6MGY4
            WnBCYkFqZ0ZjeFJSdGFsYlFjSElCRzQKLS0tIEFwbnZ4a1BSSjFSdFJDWEZnUTVI
            U0wwQjYrZ2hWOW1lNFVNWXFwbjdBQUUKf5u9g1SVuf2le9Cc9ZRDJu+CMawieH9u
            Kfp4PcpFQ66xEYtU0jBy5cgiZtss5mDq0MTlYBBAfVB9wOej/AxOTA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-06-18T14:58:57Z"
    mac: ENC[AES256_GCM,data:BM5Vreaquz9fRfxQ2KwNQ8/cCBKLjDAhVxuQAWNj8+LiSCXsdFDIOTODX91FKFEcUBddKZ4c1mNYFsD4FzUZrAfDXngQToo5h4/wBSEKlMEsvVYihzs2HwW2uAl0sZ0uUgX1f9qXClqs/XY0UUydJmCSRzYfA1BZ2hKXh5QDenQ=,iv:zI9FFDapDZYGvv0WWfWIIUgl9BOxlQW+XYDfmXPckK0=,tag:yf53TPlUjnZLdmzVY0vwdg==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
