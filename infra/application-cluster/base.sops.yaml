# Indicates the schema used to decode the contents.
version: v1alpha1
# Enable verbose logging to the console.
debug: false
# Indicates whether to pull the machine config upon every boot.
persist: true
# Provides machine specific configuration options.
machine:
    # The `token` is used by a machine to join the PKI of the cluster.
    token: ENC[AES256_GCM,data:vVELJNI8eIeQs+FwcXz6qviWXYMUSF4=,iv:9lS6gVuRYVCjXpzrG+mp4LoaPm0WWJqY+/WZqrvwK5Q=,tag:+iZ9q8nYbldeQ5c/vJRn8w==,type:str]
    # The root certificate authority of the PKI.
    ca:
        crt: ENC[AES256_GCM,data:FftJGElIzJI4Mk8djUIbQECIEo/VSc0Z8R4D5Htv7s1LDtoCETBmlNhVvgt59dFtX2ezpwd5hZuqDBABKKiI8w0ZdXrGd3dNUY9cY3qyBbJo76chRQyWFQ7qdBl6otzjedC3PF+a2jxSx9ZgnqUlzBw17CgsLHLO1QGJQwo7EYX+Swk13lEKDKS9A2m7/eKOGTcu3VPlXa0bCBdq5mcIKvlG4wmI2Z7tWacaJunis9Lyi+Bq0gqhee8JuORlY8WcmbF/DTb812IIgcRngiNMdc78CVntBpbCcUU+kDObGoHYI9/4/3c4fwK3+FjKtR29sVerYR4DbcmzGnyhc5pvXGxdLHdtoMPuS/cftQF8UtITwSWFnc824YUE9XTTxWzOkMiut3IamSTs3e/49auZZIPUEYHiSuHS5EBPQPICOBqoQxL5yuA2JnGQIqRe4y1JJ4YOliDTojnTiG4AGvzXlZcovjlHBUpkPF7a+aTi9xtMJSrTJ6dKBWINS8pUNV/ojBHsaaZBf0qdmnqHu2e4Gw9aM4Rmrmn1hiAP5wWE/XmTdnO8235jge+/555ummBDI6+N+XhKFTZy/uIluYIetiDOxyTAJVUuUuwJ5AT93ABq5C4j6rbKCak47QVjP5s6KOsJ/qwbbawzeUZ1+SgWCziQAgbWXJGl7M7xjRk1fc87xCVIf/BtAGqA9yAby7bLIDT+IlckLOoqWWFQlSFDD3owslUbM/h++RZH024H1rUWYsWvEC6AxemHB9kPe2pzk5rpMr9nyuwTQqA94+1O0xZiobXbB7QeD7UvZr4LAj8fJlEmdkLBB/CFRkMB851VHrLFbLJiLjfuyQGFFHIgY7hI8zqeae6/TJYp25SzU7ZxsCXY,iv:OcRAlAxX2kaYsMz6+o/BP0aHAcZkmzA8pCORkLKsVdQ=,tag:kmL6FNRzUBx9pS4R4vgipA==,type:str]
        key: ENC[AES256_GCM,data:MiWDYaJL/NdtjA28hG90K7IsAsjGWUwuGJQ6w+RJFyll2qaSUoqzENt1u52yZgqT+FCE3TuxKN+wpZiVxFcRLzw0FWeTo0gk5pQerBHb4ajHXMse54hb8ctu94HW3ZlBSrsvb0HBjs5whCGGj1Lv3diqV65tm2/sxO+ceIkA9pLe54iKC4s/JXj6ywMTuz5QaL0mCyWV1BTeDthfxAeIte7j8Hgn9W60OEZ458GbWBjpMvog,iv:uv9W+DnLYKJx6+7Wzh+09NfljNYUWcmB0Yraow2GKaM=,tag:DYj5YEyvhWgtE883fqfUhw==,type:str]
    # Extra certificate subject alternative names for the machine's certificate.
    certSANs: []
    # Used to provide additional options to the kubelet.
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.27.4
        defaultRuntimeSeccompProfileEnabled: true
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
    # Provides machine specific network configuration options.
    network:
        interfaces:
            - interface: eth0
              dhcp: true
    # Allows the addition of user specified files.
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    # Used to provide instructions for installations.
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.4.8
        bootloader: true
        wipe: false
    # Features describe individual Talos features that can be switched on or off.
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
    # Example configuration for cloudflare ntp server.
    time:
        disabled: false
        servers:
            - time.cloudflare.com
        bootTimeout: 2m0s
        # logging:
        #     destinations:
        #         - endpoint: tcp://1.2.3.4:12345
        #           format: json_lines
# Provides cluster specific configuration options.
cluster:
    clusterName: application-cluster
    allowSchedulingOnControlPlanes: true
    # Provides control plane specific configuration options.
    controlPlane:
        endpoint: https://10.0.20.10:6443
    # Provides cluster specific network configuration options.
    network:
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.25.1/manifests/calico.yaml
    # API server specific configuration options.
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.27.4
        certSANs:
            - 10.0.20.10
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: restricted
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: restricted
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    # Controller manager server specific configuration options.
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.27.4
    # Kube-proxy server-specific configuration options
    proxy:
        image: registry.k8s.io/kube-proxy:v1.27.4
    # Scheduler server specific configuration options.
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.27.4
    # Core DNS specific configuration options.
    coreDNS:
        image: docker.io/coredns/coredns:1.10.1
    # Etcd specific configuration options.
    etcd:
        image: gcr.io/etcd-development/etcd:v3.5.9
        # The `ca` is the root certificate authority of the PKI.
        ca:
            crt: ENC[AES256_GCM,data:Kn2bPzulKM0k033+UoIpN0ukxI1laEM9d7/LUvpR9/Y4bIRIqtPhtdT68q5t61kNxo1kGCc9/1wYcwxl1G7zl3CI3kcr8mkXFi+5fO/7+IwvXYsiuCAsjGLB3XZiwU616CsrT0tJ6fDj0dgR37bGx1c9rzPTYvdlGxRWaOe6FLFZy6sKIWHPD3qb6ntR2KnS/IKnZl3aCUypOS/2SMDtAiNDJnjGYg2RcLOdCXTL2pJo6RHn02uQKYRIZX8H7Sv+Vw1K/4JXw4IbQhtAc1M4h2tH588Pjc+2qg2PHNnI0zLkoA2COe6cX0NQ1ozs0m5F8gifY5DjjG0wxfNTsByYFGPFzSDME5jsTr6EM6LLLh+091XczbYJ0RQCSuK1crn3y/53MgYEuaHYz7sa5KsmNNZZrEZsGXI6jKmEyrLGuBnAVhosxOEa/C5u8DJOczG3iBTRmQ2+bGhktQrrUGYQcls8XOIErf+DyjrlCdsA2ptmZhf98FGY4E+zigjFMKYukrmseHP81rq7Pxu0aIqNsMJZ7TMH2VD8BqDUhn2UJ/IKBC5JtVl+prjKloH0mZhfA23K92IKfROZnvn9vCz2wd6JlowdxL2YJpSC+qnohhPkeJ63bYdVX8lP3XZp0J2XThwXGGawsYWphULTbUzCx7g18Y7/9t7shd0IjqF8g5WEgYaQjx0FR8U5tulPz25R54PQRXKC9/PMawkUTWBOp9r+YG+6TCwrVlo9J944KC9mBLUjLenclVxdUSOtjVaz4mW9Jx9KQL5kXuQLME7cU7hpnDevnz3AYXyyxY1BqpqttS6a6O3LWHgAbLXBZ+EhyBSQMMNsTH5QEQGjJ80SEhbTeRN7lnjVxV7tfD+XwBcG2cO1LQRmd1gMahJ9xUEj9uzHuptSJewhCzgsyC1MakSBpwZpaMD5/tsQKzuVaYt0NCtwxl/EBnltheZj63iX8tQle2PAqh08lD0fk2/B4ugwESNJL0n0PCXL+R6jsHO6BiTdcd8KaW9TyX2II2iS0bc1HA==,iv:FAyshq/Mc3I/gPv3qB6X57rHpfCXbKARaPzabMHhEuQ=,tag:FuYoFxlFggc7pJOEbT7JeA==,type:str]
            key: ENC[AES256_GCM,data:1+6Q5DfeEjCW+izoVV20jiJ9X864msike3tesV4Jm31tGsEISTlbP9NcqCGPAbmdTg3Jg57Q9SkgmDxII3sikjECNMvoVtFvxpH1u/O81tFnpuDPP/ErjLoIfwDX1JsegR9i7glDrdiRkXnveCCpT5C4WCbi776kmgVzTlKkg5Elf2JQIGG9i92+tBw2Z2f0WzNugwUuryHb3H1kUZY29T0jYFve6UH0S3/Mvhl2ngNMuL58Fi29xxBFCVBYMvDb/1m32svB3Itpl6cpbYM36PWi5u42GxuzJssCKwz1c5kaP12a3mbP9KeHYQOeupe+fbbjlG7yayKouDkxIuubEskrvbaMOuZqjP8Nki+bCEzEh1KppEWK+dOv0uexaAwkE3OeZ+7FxyTp6V4fWcE7hg==,iv:6KNCMNi/oWJmeY4hVqcxe+J+919PvSd0dAIFmPoPcBs=,tag:M1tFtRbepAlO8zIPsgD5zA==,type:str]
    # A list of urls that point to additional manifests.
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
    # A list of inline Kubernetes manifests.
    inlineManifests: []
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    id: ENC[AES256_GCM,data:1MTXK7qSoF9Fy6URsOL8wq2nvYGl1CXr1q8pQNXW6HllK6Lg55sfbQBVUzA=,iv:2H9yiLUBIumYs6Mbso/YRZmNs1sZfx/2pnKXfoffg8c=,tag:OFFnvjxxWKS1k1W8c/QFJA==,type:str]
    # Shared secret of cluster (base64 encoded random 32 bytes).
    secret: ENC[AES256_GCM,data:tMM3ogAb4s90yJ1HRrD6OQ6N6AuEZBGSisIjjh/RL379ZGkuIYyFTak0fdg=,iv:P/0yKQ0wFJoMnayN/uwFWcazvfQAndr9Y4ZkP5wANs4=,tag:U7ebCxZdsUKfR/wI2UfUNw==,type:str]
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    token: ENC[AES256_GCM,data:wHDRs2Lnoe7yym4IBaZs2eoTORnGFb0=,iv:qyoylyYA1I7qeIf7hxew/6FJ6aNiewLtAxwkO+BgJIM=,tag:d8NzLN4JC8P8VLvrWh+EVA==,type:str]
    secretboxEncryptionSecret: ItdiaTKG9ZobXt24kPhi1bdzRxESOz1Vi+cHojjv5os=
    # The base64 encoded root certificate authority used by Kubernetes.
    ca:
        crt: ENC[AES256_GCM,data:LpqeIWZ7LE52+vVaqIeaTlfnY4BcKkQXLxvq7zmz2q8tjd+2ZH1PLt8fjFPKZIPgXQC9Ec4ZYMl65e8wNwiLDH1ncLFDeHaagGqjEHOQfYNYDD6AirQnRghlzmxpT0ljK4eqBjfcDqF0eQo38KnDaUacrqx3bKN/NrYWpPE5mEuXFXEK1FgKsp6IVzhvJv0/zVPWc2HqRhXiLBNAbafmbR3wHdgI9wUvZyV+K5tNiwYf+XJDm6ItpqhcR7SlK66IMlht2rzTHdv/qOcEPCPO4FAp0FzD8R5yV/4+V2lsihVVTJFdcwlmYWVSUBGsiSCH+6ZK8DimEuCPwor4CiqyIlUVTFWe0Pplq+dHwURI0k9gmh4oCgwEMg8TQ19o+6gLqmQ6L+lWuXeahbgnnCtCT6OYTkPYoXeOSoL6uVnQ3KUdWL6tKVi9a0K1/gYGcBqd1p1RtegdtNpPrbdRnCHZeXXAS/mvbUm4Spz0x0HrpwUXgjJdoDES4dc9g3advpcWNZP545VCkVbNAJsOcAbL1thbWqkFtJev/0uGxvJUpWWbn5XknRP4MeiiOpZbvyEmeF32UVn/wfIVyYFTtkNPUZLKwhgaLFWqDj5ZOQjdVFypZyLGD1pJjF/r3QQt8hzV7V77oVSdwxne4eWXQTDjSddrDq8LGtGRLdE3VOTZxpWu0bGwYLuKmTv13ddeAcZPYfQrsJ7q9P+I0GQ56zctHvSqk23L21fdtWJL6hhc14Utdh1ql+F04xZuOTM+15Gs4iWfinCSGCTV4ZQ5sRkHGRK8UBBAfpVNXCmexlAZeVax/BLedX5I7asDmfABs9A2CLr10V6SwGLqlW+F3TrtpHS1MEBoIkJSnRClN5CQyXPZxeCSssbadmaZILzDPy3JSZfVlk4BrgiJjwIvmp/jq4Z310U6EL3DCK4x5448JO8qwkIZYaoeVZPOpfwvD599DpEgD9m2C25Z2vKRPj1am0IBiaj2NkHQbirXYGd8dxBsKVb9R8OQgot8WgV6JhMmOBR6USuwqVSeS3wgdOZ3vLbaFgywhHkoIT66jw==,iv:Snm4nMytNLOVNZ4AcgmCBYL8SV57ilT207+b3x7P79I=,tag:miVuUCAFTO69sVUb5dxHxQ==,type:str]
        key: ENC[AES256_GCM,data:IAzPcZJ7KQzWx1g/VDRZLiiPnr/cbrcvkW4HccJTuaTEllhPby4bxPqqUROkT2gc7tko9cNi9aukfpvfOKm63R1XL110eEYhCvA0t7OvOF7IbXfwHHXY7bvVqr08sV8ydAY+LO4B9Z0hMjNBcsTYH6UJmaGlq3tH3xKnlMoh3vGUn6YLZawWKoj+hv+k/1+d/l7+RvNztuKuf+5ixSKNpU/UxQ/Uv55tOmscE3HfYtZ9mMot3T/QMvo/sVOWTjakI8c9uiHDJaC3r+XU/u8gyjiNv7nnK2Ya+EkQ01/cqUR0Eh3/EFjkM16pj/r5zb/AT/2oQdX00EWl+EJTyyL6qhGRkpgCmsE6r4RYbDb11GF9mlVq4jCkWAlOij4fdiE95+ioKfokY+0Udt4OB8Ab2A==,iv:Zj0r2c+RDimXXSIResESFYDDaKR7brcNwsBdttIXSQE=,tag:oPxUfjIXjp3zkeiZUHFWcg==,type:str]
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    aggregatorCA:
        crt: ENC[AES256_GCM,data:nHCp3V6inxuL0Crcym0lEV8xZmdirmjJ+zumLpCQIEGAQ8XlbnoUCDjhrVvjnnvktfDeWwg4NmdphcYmFOPq+gbAcMAqdRS6kY+YiDXboqf8hjiqqGsKw05gdLwQIZ6vvXa4HnjoxXeyQZMQJDgsv2SfV0IAIHC5k4aLnpLoG0/oOBzahED7FAZ6KMJ5LAmbYHCWGRvEFbgNeXY6cH8s/wuTIWeQkQvBM9+s7beB+InAFRYYGn8NJWzwqMqEe2qWhwiNvojDyp3LzJ5Enir54dyjNmMJWiLut/WDU15KeEWXu7jM3m627uY+b17HdCK/ZPRsgyEHPJ6tEDYBuHLA/uJWQ0gGDSl1a2pRlITKO2yGoJDjtxzDEBv1gtNuM+3fgxT+r8GUx/uwGWCABxGmSRJTN5uReATzqs0ArYv4xWZfRcPoL3+8uK3yfkBsYsY7H439AUqkll2IxMrcfTGv387dQAG8NyzzaRpM2pCmM6slszLFOMmZ/AsiC4KZqUKbEQvvo17kpx/79RCVZjXTdq46zxCQ8xTZTe+96dKKQjd3wghTpa7VLNhdRntkxyDOFKNFceHBDuavRQnLSZa/E7oK2HDz2ApDNOjMwJ/hWimDRK3MpPAAdlCfMzUbUN8wYkOkl+8pQEkiCCd5UwdMuS6M1YFNkiy84wjXetv4BKKZm0srXzKXD0P/f45EOw0v2lkP+y4e4WBkpC1+BC9jIrWCghrEY/i88EtXs9ztaQR2rmZQSqBv8rwTt7qCGT5RGx5m4BqVNGn4KkXfbwhYEtmZEtuhDk2nXdcHxPdvNDFdP081AcXUy/tNEQ2chIKcBDXyDQ9mQSEYeZb+5+CmdkyCLbOQOZG3ZkzlTgff2diO0i2/0TOuz9lrFo6u+sJctN5WCKCf6tR7yqLUg/cyBDRg9zPRA0x98otZnjgFgYyfCzXfZQWph1SACHVOBhba,iv:ggF6PgbmqLj5AwENXmu2iFfGsXHeo/9Q055da7KjIyY=,tag:DksZhJ89hVyEXyKkc3VyHg==,type:str]
        key: ENC[AES256_GCM,data:DKi9QLS9XZThOu9S8MjOn97dbEEytJevnL8w4lO5c+u/g6Q39Hw0ILMwthAhp5AqE07BltVh798cnuKiQ8qZZdGP1pKwA760izCt81v1yrXozGk4hWRDAXh965Rgfbae4qf2nB+wmn1k73ktTMkFG9KChXqnhcZKAjsqRfSg2wg6bwS60Bdno4K8cWZ6prGqLY2ePFUiC/DkbbEO0edAmFiOOPBNNVaRPmjEzrp+O1dazc+Xl6L25CvH7objAMR6F0c3dkKc0Pi10/gCySIN/euVBEI4AZCk/cReZd2++Yd+/JjQHyFyVU2xKDkIdVrDbbSQtIiJ8cC8iYsFfZuYFtv+bE19HL5TYMLFQAOcRkWqka5O2Xk0+HvonL3xyYfEUq5xH/GMqcRHMMeSuctrnQ==,iv:Ws1gj68MsLmbAelQKyN5/rki2H4pVn9/9JjJEzmNvCw=,tag:aGeNBFTIxZs88sZEOrEMZw==,type:str]
    # The base64 encoded private key for service account token generation.
    serviceAccount:
        key: ENC[AES256_GCM,data:GXvN4mBJM4yagaldor1w9+5tZAtQ9lSxeEqer4x9Hu7Zrci4BjMYkwJusiyBXB658/usZk7eP1WQZSYlFFuu2P/ntU4l6ZdBw9FgWzRKTvNob83kj23gycQ+Yiwtu50tZF2xplaQHcJ+LXM8JVPYNb2OILl/IFR6yem84LaU4nvG3cu8/yBRp1E2/LKKNXQkRxxw5Qg+pmOM1BOdeGSaBj/liAG4y0GdqVkUyKThFaj8zUTLrBuK7Ln0WezrI0BY+SGFNtQjkJWtjGsza4+xPOFOCPVhMHOfTinuqNZ1mk+tNELkTlnCwq9n022Cyl3mynmzQW4U0vCZ8kOstppFStiHxIgEKQaPW1aEo2djGMqz5DJJKz3I93tttMj+kAHUjq9mgCQZEaatdcBz62/axQ==,iv:DPqU9V/spYV2TTFJTQFQxVDKLZxRjkjYlC7yomBrE8g=,tag:SQC8+QUR6YrHdtckt7vYCQ==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBzenQzSWhiTDJEREFzQ1hU
            blI1MWdVNmVyOHRZd3prejRvZnVLbmU2MWswCmVZalExMEYrK3lkT2xnTEVOekU0
            SEdWWWh0Q3FsUEttMW4yYjVwR1hvdHMKLS0tIFZRb25wSVd5bVdTeHdxRWlialZa
            VEo4RkkxTitiNVIyQVFQaXpUTWxqNTQKbe4iCetrDtHwD/80GwN0mIM5I3klbEvc
            FmZYknt5W7yOPhZoWb6dte6Bvr9YrFSUoCKrprZhbOPVBlQq8Hei1Q==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-08-17T19:48:27Z"
    mac: ENC[AES256_GCM,data:poNXjrQzAV8LHddX7pZpMiPPn/Gjgl8a/sYqj3PY8NDTJp9N50hCP31OleK3XYdT97V+/Mx/uxasiECKzTz+7plywCxxF6HcJ81iNcgunUtzhXvCCR/ZjpSaYwpIgkvAZhE42YqfRXsdj9JueTIGpITcSpGoyZn4EDD+1VXFav0=,iv:c2Y61SMqEs35eseyAP7Ed4jOvfC30K51UHxi35aSpr8=,tag:EiOck7FloLwLHcnOIM3zdQ==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
