---
clusterName: ${HOME_CLUSTER_NAME}
endpoint: https://10.0.10.10:6443
domain: home.mirceanton.com

talosVersion: v1.5.5
kubernetesVersion: v1.28.2
allowSchedulingOnControlPlanes: true

patches:
  - "@patches/cni.yaml"
  - "@patches/kubelet-certificate-rotation.yaml"

worker:
  patches: []

controlPlane:
  patches:
    - "@patches/keycloak-auth.yaml"

nodes:
  - hostname: hkc-01.home.k8s.mirceanton.com
    controlPlane: true
    ipAddress: 10.0.10.11
    networkInterfaces:
      - interface: eth7085C2588D31
        dhcp: true
      - interface: eth6805CAC2ADFA
        dhcp: true
        vip:
          ip: 10.0.10.10
    installDisk: /dev/nvme0n1
    nodeLabels:
      system: "2U"
    schematic:
      systemExtensions:
        officialExtensions:
          - siderolabs/i915-ucode
          - siderolabs/intel-ucode
          - siderolabs/iscsi-tools

  - hostname: hkc-02.home.k8s.mirceanton.com
    controlPlane: true
    ipAddress: 10.0.10.12
    networkInterfaces:
      - interface: ethD037456F2229
        dhcp: true
      - interface: eth1C8341325597
        dhcp: true
        vip:
          ip: 10.0.10.10
    installDisk: /dev/nvme0n1
    nodeLabels:
      system: "MinisForum"
    schematic:
      systemExtensions:
        officialExtensions:
          - siderolabs/iscsi-tools
          - siderolabs/amd-ucode
