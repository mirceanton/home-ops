#
# Indicates the schema used to decode the contents.
version: v1alpha1
#
# Enable verbose logging to the console.
debug: false
#
# Indicates whether to pull the machine config upon every boot.
persist: true
#
# =================================================================================================
# Provides machine specific configuration options.
# =================================================================================================
machine:
    # =============================================================================================
    # The `token` is used by a machine to join the PKI of the cluster.
    # =============================================================================================
    token: ENC[AES256_GCM,data:7Tj/sON9qnBcq15KaIejJVutbyyk5BY=,iv:KtqT1zf14xj4EzhmAuHBZcxMwIhsIMXtpyP1f4eSOjw=,tag:G1a8fm7ouqGgmO+xy6NCQw==,type:str]
    # 
    # =============================================================================================
    # The root certificate authority of the PKI.
    # =============================================================================================
    ca:
        crt: ENC[AES256_GCM,data:X/dJi5VMXShOgvollZAlLvmbKfscR//NIw/pOTmOJYEkXt/NiuzAzt0wAklZSw3B0pja5AJyaOpRPN/5po6ejTpM0ohuuZo2RXOrvHOfRcdNSmAEZ5mkBjU0zMFbTeJ97mFofTVHChIJ3kt144dnuUn3OWwbTtt84yIHMPmIe70u0gx3DoVh0huxbLg3c52OyZxkBkxeDW7qgM6cmNn8aLYuzpWHe/5gW5T868ZgIveC+KLrMgkM7tcCAH5JCkxE2wx9DMsE3gk7vuT3xExw0hb1vFYUrtvqDVT9/whzWYK5M+jphN2RBcIy4NG+mZX2HQf5looNAdeNMlMdbXjXN5lcJ0zXgbwg3sWrFJdQPeZYnDUkz2xYr4po/0OpTgTeC7m8tBEpI7+HXGunZho9nSYfxVDoyyisHuXj91QBUtcRbobs/cTLP712t+TUVROWz3A7hbwhEBgXwbuJoc4/1zh8Cjqy0/9W3tByCYv1B2YkRycg08c8e5ybw90m8jfU3ku41VjdAYz8zKwJ4iza2JPLZtkepQgViSws2H6SB1Uo7yjRdBNvsJtmwPa3zSVqZZSyjvqwDAlqH/ZtLjIFqtVjdyiVh1fVs9U94FipfyBFcG9FNpZu31UGMWEW9uMbecexQN0FfpUZOlccXmZAgzcPjclfJmmfXGTp5mAPBD0PPIEgr6Bn7Ul8lPbRGKGLOhHk/a9JbuVkRbD3YeJJV/sToHmP+72BK6PoUE3ihx1OK+d9w0SrbhMqZ0kd4+5NhH/CI+9m6d/aNpYJkpBgNxSCI7ro9iWoC2nFm3yQAGikUdeTKl2nA7RLLoqkBJ0lSe9KIV+i6OG7wWqV+rgXs9T245m0vBjrTVhbNxifX4wOtsLd,iv:OLvYkibM+YMJKIBCrqYQXUjbgI1Gfb5BmxgS2euWU7c=,tag:74Un3hSo1dXb8GtO9vO5kw==,type:str]
        key: ENC[AES256_GCM,data:kwLLHmzVDylQmQxQZGhL5c+d3lTzHgGXjU/ewZUV9fSUn16VVDfJf6wjIyM9i98+Xo6fVV4ghKgjyFzSU7SL+0Rza9IVgpGYyemIjDNcb45EjiFbmYOr5rL5mUZlkzPDcgVbCF6jnWG2HNVxS2mIHEXa9kLOFIYB/Ro9SS0HXKX30u1aBO/oluvrFktfcmjxU03s9JgXA6GGyPDVqr2iBdIyTdEFAHxhrax4+a78RLQzy2Ct,iv:3u2WUxJKjVppBzwPWQYWRr+TTikC0N2DDLT4LAcGyxs=,tag:5kb8LbvuPtjR7tWwC7F67A==,type:str]
    #
    # =============================================================================================
    # Extra certificate subject alternative names for the machine's certificate.
    # =============================================================================================
    certSANs: []
    #
    # =============================================================================================
    # Used to provide additional options to the kubelet.
    # =============================================================================================
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.28.0
        defaultRuntimeSeccompProfileEnabled: true
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
    #
    # =============================================================================================
    # Used to provide instructions for installations.
    # =============================================================================================
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.5.0
        wipe: false
    #
    # =============================================================================================
    # Features describe individual Talos features that can be switched on or off.
    # =============================================================================================
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
    #
    # =============================================================================================
    # Allows the addition of user specified files.
    # =============================================================================================
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    #
    # =============================================================================================
    # Configure the machine's time settings.
    # =============================================================================================
    time:
        disabled: false
        servers:
            - time.cloudflare.com
#
# =================================================================================================
# Provides cluster specific configuration options.
# =================================================================================================
cluster:
    #
    # =============================================================================================
    # Configures the clusterâ€™s name.
    # =============================================================================================
    clusterName: home-cluster
    #
    # =============================================================================================
    # Allows running workload on control-plane nodes. 
    # =============================================================================================
    allowSchedulingOnControlPlanes: true
    #
    # =============================================================================================
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    # =============================================================================================
    id: ENC[AES256_GCM,data:1kleka3WS2eR88lQNJmqf9t1S3NWrQoIM7l+4GXMvHlHXbY5yHOl5ZucKNM=,iv:adQsZ5Vp9JRpyMoWzqCPiBViZnYMCb/FGeawAxsqbw4=,tag:Oy3IIj7LFivIdHefYpEevw==,type:str]
    #
    # =============================================================================================
    # Shared secret of cluster (base64 encoded random 32 bytes).
    # =============================================================================================
    secret: ENC[AES256_GCM,data:KnxQ53fhgMT2fVOlI3ogWsDDIkJ560zQIciqRVs5jSKINPKlW1Wg+NKb2Wo=,iv:mYKqL1FPWxnu7zdRIZLxyNiyYO3/5vPNqWB/NgEnOyY=,tag:i4k3fmOUAm/4vS239cRVHA==,type:str]
    #
    # =============================================================================================
    # Provides control plane specific configuration options.
    # =============================================================================================
    controlPlane:
        endpoint: https://10.0.20.10:6443
    #
    # =============================================================================================
    # Provides cluster specific network configuration options.
    # =============================================================================================
    network:
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/calico.yaml
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    #
    # =============================================================================================
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    # =============================================================================================
    token: ENC[AES256_GCM,data:Vb/sYLJnUg0QPUyGoaWXgmPHQRexGRg=,iv:iDkrWKhtl5+zbMt5WRkKiA/J6CHMBWFVGIozA9PTfeA=,tag:WTj4dBUmxR9+QJDRhmcdHw==,type:str]
    #
    # =============================================================================================
    # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).
    # =============================================================================================
    secretboxEncryptionSecret: 8VFaSKQ3CO5Y7fbgyFK355UgmzCERwZNnueDHWqQ6F8=
    #
    # =============================================================================================
    # The base64 encoded root certificate authority used by Kubernetes.
    # =============================================================================================
    ca:
        crt: ENC[AES256_GCM,data:I0Lkb70kcKdU8N6Xp5OM39ZbQcHiStFc1vdWxOipjSJbS7qh/UzeAuEMMeDp/oDbrhPN5t4QMchFB5mO7qvqy1u2ydfkN2/1MV78UbBXZYmERI4wKaG2dN9obRim3z3kOC5hcobEYZeifz7TtLDcizUaa8Yhx/ukFrg/suOWlBcd/Ii+mcuZsEmCVdDenmOtbLG8oSu6AZZAwtozqhOi8m6yi1jsr3Jl9e+ISiFMxayzkwmwnYKe4z+AomPQnPbIxjXdcx2d/4uJ0wzvnxEHKmmbZEkaviaYN+S0yen0f+aQpa0LF92O2RiDRoskUIxHl8/7ztLcSMvrn1DtN4632BlcEoGAof8qC8Z/+vrAUcNE7jKWuzZqrz15VxOABAxbGO1Vgb33xuCuuXSpkdCeBwqvS2MgKvkuw4fH8ptQ7D0VCesnKoHpJ33kJZhUu4oGhz86rDRtV1b0xIgAVDs4EoQEw+jK/7YRUNaTAvFWmVeVkal9j1eWqT3ZhSiZ22oYcZ3fEY2Txar2FkepzCLieYT8M6xeQF6z8YALQ9elcF5QswHRAOKlszDPlqr3MDIz6L4It4+q5PxGOi8mbN+hJVU4uUqRGGVh1DQ1hajVskibmyhBGk8Di+GGxpAnqsNRccdsCx/fzfMkTYVJ02bagP7PahcAu1Id14AmQC7mEOfX1bkcMk7m6NKjBTVHJPBivYQGI/7cCAd3qpwwdx3NB42iYQSWmaGBL0Hgv+CAi4bBIfvSdyfMJWV3KZA4H4W5aTS2X+mnB8LOcfvYIa5kSpB3XGXEOxwCA/XUWZ0UdD/l+QMDKodZhvDkiip6dcLXwrfzuTG6T/8gNHsYG4GHcMV7FWwmvFLhNfZlQngbZF/8nnqJ/rVG+Gf2Cp954WtyAH0tUFDyIC4tBHGbcM9RZoykMJOWz7vimKs9J0B3XAPeCA3pO5AOWgr87IK9FodZzmjvATxaIsr7UHQPoScP49ezU8W/VuiGTZr/9BkP0bitVUqrLAUgNpOURsTRUYxW6YXGRn3qFKFUGeprHn4WS4butgOYh1SEGIcqnQ==,iv:Dyb/S1uvPT23yTIjvERR9JWT2W+VYhPbtmHIFgdfgug=,tag:4iMEzZ28mEUxFX08rULr1A==,type:str]
        key: ENC[AES256_GCM,data:YDTBpg5i03N+q4nTAR5zbgu87NLLusbSgRMnUqMEtfUDBUw3uK1rgLPeMTMVAC+7inK7hxD0w6hf26EC+umoaeIu/Tkmyhn4YWNDbIwPYXy7XB58AjyNmuUQ6hab2IygwIazeZ5kyCK1Imrv21nI9XvO17gxcVmkP3DcsQ6d3uRTMafrEUGu7XqYUmm7jw18qBRn/EBh/k+1bQLmjdkIoW6E+OjzJw8xuUDLtRHPDsMAMVNlQQBZYtLLPV5Vk7MV0XEcQwc+rfK/tPdnf2OyoKYi4cwG+7GFqKKfde5Q2YFzylgtmTHXx0K6uu2JcKb/JRVFBQ0iLm5rHhtTSY1L9KYXM8M72dOkuiyBx/8RCn5/euAQySkhwk1z7FyCZGmhvEgW3igN5QR5/6AohAH7Ew==,iv:CQZ7WUEg8T7U9iqE47/ZqLn4hJp9BDYtXm05Bz7uI3c=,tag:EZfKL8rsxeOSDuQ5eWa4tQ==,type:str]
    #
    # =============================================================================================
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    # =============================================================================================
    aggregatorCA:
        crt: ENC[AES256_GCM,data:CR9WZLwEUm/JsRoMVT6A5KaLH95321nLfKzQCuuAoIK5vQHi7VKG3JA5Cc/gkRl9s3T0N5FIjoByEG7alq7Ir3Fd9ZmvgGX7R7tN3hlD17gkJ02t7cD9er6nX+zYUleY9QECL+H9KBNQGWXSAyAkd4w+e/nGq0WkJEAYVebTZXiTwPTziMbqsiS4YTzVw4+SG6iUtm6WPCoXjaS9K+Z4gEEauOgBo2bRfvVHlbj6ymiA0rpHBYn4bEj1ZmY5M1djrEeWv+92Emy6joZOyTcrNbIbp72BkhK1imIZrUn53Y+hNh8lsoy651cSqqE/6BGJL67ai4+Sjx/LnEYa0H+kD/UFNRCcAmYyfOfC05isEKyjzx4E9xwvY/GCGdwp2YGSj+v49bt69sxIyqTL1uvlKBWXmnyRv7q6FPgNKnPidTeTzMAujttGGzN2Y8YZcDkWUeQQtrefxhJQLcUghRsuByxwtp5VuSXwvJ6mz+0z5t6wdOUBkpwjVhUw194KWty9u21tycXyhFyUn8JSQJNzWQw3FNFYCpgrPxdVFZ6AmzRJud2Vvq+KmBw4jtWfcHD2mZlfNbcrvR36MXqtroP4rHQs5Tmu1zf85z78KR5CYSpzG06slA5HJDLhoxxfBskFOr6CUPF2YXQMVMBNdvIzTtHi3NRWg5fNP6I+zXuCTO8nudZ+c0xBdiR9rsw5DnGXX6GL3ZDMOwQf6t/SezYhBx7pWiYsZvVIj5TaZ6tlvgWHejtOxaQWaSZklyPygEsb3fD8GLqZLOgkfFm+dDyeopLOAVL8Smn3wx0ockiOkqfVMdj9sVstnZwLC7s4bXX/eGYp94Sy2TBSf+TKVhKJtitpe5K1jEQbd0LKPR7rjrRC22iwVEeD8BMkUDu2QeS+P9fpjWZ1TTnd/bGnqH9vjKHarQQGPYmsNs41+g/ReJAulANsG4cI7g==,iv:Xv5+dO5J6LsNEbZ+TiGV1BTpHz6C9MBE+SZA4de/6D8=,tag:pEMAtVbrBqRqIrsazt+GZA==,type:str]
        key: ENC[AES256_GCM,data:ARefh4Pbf2ctxUu730Z/wCtdGjlIRU+XgU4f8gmeaNZbGS/3pKx128jW9STd3xVwWXiDooDAYSULjTmm9JJXO488WV0kAxRoj5CgUL3hR/MYfE7DL94OTQ6wRMXxA5tS0D6SUqtnByzpXw85rjsV5vd4kfpUqLwhfR3zsXRNbSrdcv+40HeEq0DX5H15xcjMFHfng5Z0aEGe47W1OyNTRm3TPxI4337CS38bMicYH/8qq2d5BvVJmYTYfVrLyjVUu4zTXX5lkQl9bsB8Q3y+J/sfYOLgyy3WhntJx3rpBMmzchlFX1hh/KkfaDVetnza7QM75CcbcDWCfYWydsfCkEQ23IgeZ77so4CeomzoGdjLeHoTZ1/TZnpBpsBM5RzYH6DN6+/BMFIqkIVA2ewhkg==,iv:CB7wpJ3jWlXQLXS9Qz2+L1rzJMGUtO3sy57ec9OzJx8=,tag:Y3FdtZn7QNyEVs5aDhfxMA==,type:str]
    #
    # =============================================================================================
    # The base64 encoded private key for service account token generation.
    # =============================================================================================
    serviceAccount:
        key: ENC[AES256_GCM,data:wWDymlG8yuK09K5iA3Q6SNDF+uYuHmDuRRXJESE0+NY6Co9+qcZPmcs9LYsYP0CDSEqvmnEmG6QinkYe0LVyTzGrsyY7PESci8UY/sjEwKVUGI1gMNG0fBlWHBMIRt06hXz2sUhfo9GtwdB10JAptmBiUB8MSe+P79XaHL2beoRWBuiW2rEToyGPBR5Xg6xswdpXQERIYk7Q6GbESoa2ItxKvOXgzA5NCds5QKBb8bDWneQBiGk0gE6fWKTJKMVjfjm6AA8qFlveUk6qRbn+WvG+gRpWyX/la7Wt2t2yj8IV2i/m+eyE7b6Pd6yTGd1YlTgTxVqVOqH/5LT43ZkgjwEKpFxrcA70VDYXmzky1ouOPoRvbg33n4G5JIpqpNXXPnuKki1UDxkB4y3jHPMrWA==,iv:YV5576LdAhLZB4HJfw3avZtaRg5W6SSJYt9metjue00=,tag:/YjOx6HpanRFkO/xd9MXXw==,type:str]
    #
    # =============================================================================================
    # API server specific configuration options.
    # =============================================================================================
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.28.0
        certSANs:
            - 10.0.20.10
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: restricted
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: restricted
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    #
    # =============================================================================================
    # Controller manager server specific configuration options.
    # =============================================================================================
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.28.0
    #
    # =============================================================================================
    # Kube-proxy server-specific configuration options
    # =============================================================================================
    proxy:
        image: registry.k8s.io/kube-proxy:v1.28.0
    #
    # =============================================================================================
    # Scheduler server specific configuration options.
    # =============================================================================================
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.28.0
    #
    # =============================================================================================
    # Configures cluster member discovery.
    # =============================================================================================
    discovery:
        enabled: true
        registries:
            kubernetes: {}
            service: {}
    #
    # =============================================================================================
    # Etcd specific configuration options.
    # =============================================================================================
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:H1wiBI4XyqkQBLrcec/JgInx2CDOc8u4sCg6Z4kuLyHlbtQ1Q3RZcHiYK/wPqVaLUcfTrUj1Q6BSdwaULyHPCNo97bePC3MPR8F27B6u8hDjUWRR51dtEtwSS9crtDW503D4n4zV6XnwN7Qi7CaK9Na1WJJ6jC6xgQa7IVT5+vSbEctei+SgRGOMNXLX83GV7PJBoNr3Wnplan9dZZYC6vwb7f8DnApoBOYfou6vdn4qgQsplexrP+YAz368c22dMB65PKcXm2veDTmRELe/H2fH4pMn9RkboxzF28ciBUG+nSFHIxRo2klqfsrjCITMcmajkdMX/3vWeYj9foFYArmOe/OTuNqGmtrVloSlWohIqo7fKbfYtgekjShMC8q2efemyrwO6pnqYv5aXEozAgXAgmDzZXO3N3q6XIm07OONt+9mEFcGVWfcCrRX+eOdBk3Hn4crvzhlsQircVQoAD/LyI3Gz0dV9nWAMgSlPS2K+x5NZlyBwVJXvlKF5UnBzWzbBODL7Z02davTSZB28YMO1LCZDPrS/2sk2Yrh1jhnVMfCltytl+z6J7nXDCUYgLUH8eLRcugXWfPWiuXtgraMgho/7QHCryvl0jX1lRokiaTD+jSpOPKmKCfZ94ApR2/deMGxMW09/ZQKsfrVDqNTxFBh2L+Se/JUbdDk45Ny/f+dN7/A/4dUkz26NH7JILWVYW2ptZPE9z9emzocwSAWF3vVdB1ZEOmxzjFIgUy5OSGHUJkfueUvJSnNRAOuxq1hPW11WTBUv36O+OsUbnsRqkLlcEGzqGQREec9iOkiW3QxpM8rnZXfSLS15PuFOQ9PhpukWf7DFgRSTRXg68LLohXqBZAOclFS8CM/3oIcpxsCSHfzlN5CkpehW91pzekomATjvZSxRV1LBRwg/YqB5zQFIRtbyn4m/A41jwb6KW3vniElMcWJzITnTnJJQEaFAs/KwkDcY6bJwlktHZGQVWXytvDHyJnVal1xan/qLE4UMTndvcRsL4OWu7iLuw3y2w==,iv:dlBK+p+gc0iWvENZPnDMfYOIdil2lvpLt1J0bvXvets=,tag:osy+UK6XNsoS5ZinkARyag==,type:str]
            key: ENC[AES256_GCM,data:a/JrmcUcmTzWN0JozO+vVuRN7u2naiq+wTF4f/0rmzSKOlNaTO1V0DcyFnjS9M1YaP0Nw++fe6fq6TFglhGuWA0YkU01Cp0UaEgRUoTQUDPIJ43+APoNv2mjwrkS8+SXlh5NLuZKiADBXk8ahmsXnEY3dKFONFRT2otZZGBvf3dP7g/fNxLgLEqNO81fE0UTbUBOofQ9Hk+hQWWGLgKI4VZ9+zpotiJEt5gpzf1NLSsSGz2K/1pHmWPUXrj8WEPpVUPYOFvvo/+lq9mpuMGj5xiQcPmNZQssk6OdrkgF6AkSTDmX2S+5hJNK+GTjHW7Kjtv0VZcfANk+Gk6jTinw9sTS/6LobCSZ9/jQxTMJ3Z1+uG+3Z5DrcssnR7UCIL9wETvkzLGeyPJx5lI5O/MHzw==,iv:HnbewjLN10pxxDvdYLRG7yyCkBOm6Yv8vxyq1+3VOYw=,tag:L1HNhAKvDTgfvFwT0upyug==,type:str]
    #
    # =============================================================================================
    # Core DNS specific configuration options.
    # =============================================================================================
    coreDNS:
        image: docker.io/coredns/coredns:1.10.1
    #
    # =============================================================================================
    # A list of urls that point to additional manifests.
    # =============================================================================================
    extraManifests: []
    #
    # =============================================================================================
    # A list of inline Kubernetes manifests.
    # =============================================================================================
    inlineManifests: []
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBZVkg1WkRlOThXSUhCUGlh
            ZVRPZzNuTFhweUNMKzIrb29rTmp1SmpCNmcwClNONitYNjFYS01ubytOaDVQYmxx
            OVJxeDlFVDVVbDZqYzVwZ3ZxUUI3cHMKLS0tIDNSY2VvZXZqMHNqclNUQXN1QnFa
            WHhmdGVCNmdYS0VGa0UwUFRaWm1OSXcKLJ+Y319VwRYAQFIMEFgpP/w6LFQpw7X2
            5oQttsKtivu1I6Jo5sT7usaqwM/fnvaXelkqPPtGxpJ6oQMC31yH9g==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-08-18T23:16:36Z"
    mac: ENC[AES256_GCM,data:cHlqVibMS4lBDqHh0E+DaxF0A0ywN+IWYLMy+/dyKVKIgMrWBDy/YHW+Sg7+174FUpzNfVw/Dsih9JDhOSVn+NIp0u4ixtGWvtDWrzAKG8GmITNBjTVJTw29MUtDMFdDYuSZeuS7vafbPKzcdS8ELaU+ZRZe+PXc0Ge1lAP1RpI=,iv:XEMV7fUmYzngg89Q6HZuXDYCkONTJTrvdEGjYRqf7tU=,tag:xku9Ysb9poYacaqskvdZWQ==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
