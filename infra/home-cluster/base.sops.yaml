#
# Indicates the schema used to decode the contents.
version: v1alpha1
#
# Enable verbose logging to the console.
debug: false
#
# Indicates whether to pull the machine config upon every boot.
persist: true
#
# =================================================================================================
# Provides machine specific configuration options.
# =================================================================================================
machine:
    # =============================================================================================
    # The `token` is used by a machine to join the PKI of the cluster.
    # =============================================================================================
    token: ENC[AES256_GCM,data:Ts86dV0pJkn4yHVR+gaQByKoEalYx8Q=,iv:1XfCJO0BQEitj2l78VEmhgRTBY4XMamaVXX/BJEKj94=,tag:iraQfAk2qM4Z8wOHbopGDw==,type:str]
    #
    # =============================================================================================
    # The root certificate authority of the PKI.
    # =============================================================================================
    ca:
        crt: ENC[AES256_GCM,data:3jd/0FfKyxGYWkPOkFGEag4K/AyiZLR4VVclCUnRLQPZj/8R9djUR6rIxItz6BSHLxIWGqannEPiao6v3KOBAmbVOA/R8OAaUQv6ykHxYBTOkoujjt/bBjGDQp3KULAdZvF1lOp8ND/14kJpj/zT/fH0zZd7gplHPZ6Gou3TKX4cqFitPJEdTbE4AMRRD3HgDZNXT9F25IqEPaLJbOvvn+0P1ScNgdC8/xo1u70n2iPYpiNmpJcdxZHBNyp3RvyPvjREtUei8j6tFP54vuDmzzZRerMIsn/Xfg1661rAO/iBC0RH5VUW3m6tWf6uKMbjIVymhHWyr2/MGdSznmtcx2szZAq+K+NRVOHfcKnJwd0X3ahFDvPM6bj61dR8yiq8JH6itbWZQgQvfxdlso0PgyvMpBzyupi8L3p/VFPgvyCOT47aajK7P8IQU5fn9oq08WEYSIG46A4thTbyX0hevPGuggEwq61eNDPyfKXbL0ZzBri98KMfbbmi3ZScBqtuJB1jUYQRYmyoSJwogvmqbBlTGcc8yjhKPpR9Aae8ow5IEveg39GHriUM7lTYD0Sc9kBjXXpt+GweIe+12IkkEcju8y+5z7R/GCFwnNvr9vUbMqzae2Yue5EnLbfPE1m6rLaeem5wX+ZTz3MMBogrUva6vpYSvtdar68nfoQy6KBLKBHGXnfnulStihN0wEj2jVOCU9AvtmNOO+MRUrthdePQt/x4Fo2a5ijtvR9ordDngG/ggO4uzqHFh1K7YHDXe5HZgnbU0DFV2jEgg66j1WA27Nkt6k6BgVqSKSgjaHLhdyANu64n1UuA1mRzRzi15gtliSrrssxDuocaYeSAh+6sw9+FEBW7GD/ZIxlD5P8TJ2kg,iv:3zhgX26gVNlba6My+eMPJY54sfgis7tASvvM0PTR9X8=,tag:Bbdz/fp2EA5otINPQg22eg==,type:str]
        key: ENC[AES256_GCM,data:KixmY7tnqsYDq6nfhcPMNhUJKS0v/S+80Hoe5UANUoYeoMf1TPJmz+FoEFV2u2GkjEpyu3QYqM2LzOlHbN9j0JdRkwWuzl11qF6XkBELXAhNBoClNpMtKjmShZ8PoKUhhRZUmTcgwKzkG/vWfQrmfL7Tzi0irOL26TlGobSBlSfDIgdGmxIAfujJe267lkdrjgBn/prR8XP/Twp2mfncdL+Wph43gbKANAa3WzoSp7UOw8xd,iv:qYu4il27PKgY5cMaSNCg8vXKKv6aT4iIb9rlmwWoF5Q=,tag:PntGTk96pKifbhJWlNds3A==,type:str]
    #
    # =============================================================================================
    # Extra certificate subject alternative names for the machine's certificate.
    # =============================================================================================
    certSANs: []
    #
    # =============================================================================================
    # Used to provide additional options to the kubelet.
    # =============================================================================================
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.28.0
        defaultRuntimeSeccompProfileEnabled: true
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
    #
    # =============================================================================================
    # Used to provide instructions for installations.
    # =============================================================================================
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.5.0
        wipe: false
    #
    # =============================================================================================
    # Features describe individual Talos features that can be switched on or off.
    # =============================================================================================
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
    #
    # =============================================================================================
    # Allows the addition of user specified files.
    # =============================================================================================
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    #
    # =============================================================================================
    # Configure the machine's time settings.
    # =============================================================================================
    time:
        disabled: false
        servers:
            - time.cloudflare.com
#
# =================================================================================================
# Provides cluster specific configuration options.
# =================================================================================================
cluster:
    #
    # =============================================================================================
    # Configures the clusterâ€™s name.
    # =============================================================================================
    clusterName: home-cluster
    #
    # =============================================================================================
    # Allows running workload on control-plane nodes.
    # =============================================================================================
    allowSchedulingOnControlPlanes: true
    #
    # =============================================================================================
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    # =============================================================================================
    id: ENC[AES256_GCM,data:/xneSnbUbvLkL0dyleYif2FevFH/tqskTNQBKg9ENJHhEtdVqGae9Ye+nKM=,iv:jNgKw8zm4qgrv0WRllSWeYNHuanl+Hn5Iu7N2h8Qdos=,tag:63L3iiCuVQrmBXYxHE4XZA==,type:str]
    #
    # =============================================================================================
    # Shared secret of cluster (base64 encoded random 32 bytes).
    # =============================================================================================
    secret: ENC[AES256_GCM,data:kLB/L2bFVxmvyLmbOFEj3XcJPTgZGb3zOr0GWyQa5KmXsQ3TCUg3u8X3aB4=,iv:2JOFpdvoDo2WukHQopGYf/yItdC9W9h3ytxosaZS2ig=,tag:BWimF0uJgR655CJTGgcSuw==,type:str]
    #
    # =============================================================================================
    # Provides control plane specific configuration options.
    # =============================================================================================
    controlPlane:
        endpoint: https://10.0.20.10:6443
    #
    # =============================================================================================
    # Provides cluster specific network configuration options.
    # =============================================================================================
    network:
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/calico.yaml
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    #
    # =============================================================================================
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    # =============================================================================================
    token: ENC[AES256_GCM,data:xuS7wesgq8WvLbowDG2fmjR1E+70Rng=,iv:5KQ4wa0i47IwkFbkNiPYbSN1yLHdHKJVAsjaHEirV0Y=,tag:3PUJxL1ayD32/T3FO0zSEg==,type:str]
    #
    # =============================================================================================
    # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).
    # =============================================================================================
    secretboxEncryptionSecret: 8VFaSKQ3CO5Y7fbgyFK355UgmzCERwZNnueDHWqQ6F8=
    #
    # =============================================================================================
    # The base64 encoded root certificate authority used by Kubernetes.
    # =============================================================================================
    ca:
        crt: ENC[AES256_GCM,data:2S4u/4SIj5GWJ+2/Vw7IwUbbMZdXumy7MTKfGCBmkFv6Gk9fylDt/tEYOzasYUB11k2WXjnl0ouHbOksrRbfyVmKlZdu+FHfyt3+h3LXViW4q2LZzN/4OVrGQaWv8Cyd+uYVg9nMo7ZnmpqAyXSygh24bTMjAlmcUIq7FfDpNmBE64fwUQJX92hQ1BK5BBEobz0aKwMPt41CJeQIoGxZnnO/IkwP9GDNYlDEXXhIIOIWMMJ7jN/gCGm1ph8/rOnjWG+megkduVbYxUcHH6jtAAek1NZrSWFgINzcmUCF1ewpJnF7GvhlFvhzAAg4BDXdiHetkcS4oBwYyjHj0wB10exWoOZ14vI5cvJhS2XjqJVcHFxMZFH32926AiVRj1SuE2B3rNjHoIk4QGZU5HIgJ3KgIHYWKSTGaNJA2/QInFX06UA7r/5zc9aiNoS86/EU16tlQbV/Ljk3BpNzM7Ii0OC+mHsesaM9g0xPep3Gog0oY6n/qKJcg1Dp9xBSKgyno+vbmri4zrfq2P8QfTNVwNPjfjZYuLc/mnMO+Cv4VyiB0Xe18p/YT3ZM0fm1IugjSl9TF7uKmuuyVZggEQOvY3e26zLJKpUMCu3LPUU2mXfdsQIxdWa9KGvkqaU1N/vcS9AIWoclY8anDIyUdplfcTC0NYm+eDefCdu1INN4d/oUH2jvnE6uWhS8qlW5LL3zagA02A8ImH/Swy9k4K0LIlKhgFsgllR2nIWSmWrUCEtxuNhTO2dh57xHT0PG3qGfa6qWdF5rKYzwRrSJHUB7o83ZYDgCOd2ojoDH/nRSf/g3B27wZ4CtrCocCMns06qsIAQfMsj4TbHbl34tjEIk5i9RreM23raFLQ4/pIx0E/3z75+k2/5DyEsA5Bk2qYDC9Qj4jWqhpe/skkGmMol0E/29I+kitCmnDQ0VqeKPLp3aXeKcd6wkko2qKXfSAfZYJDxmhpxJd4TVovTaPybVS/zqTi7C3Mq5krhWwsK5gQYelIl31v8G/9NcbdECJYJII6jt9Zqkqefxldh0rLynm6xju2voKeQV2WH02A==,iv:O5C5qYvYiIH0eVhReckxF90cmuXonE6e18f8kBTiej0=,tag:x6MtgHy7T/E0omK5uckoXA==,type:str]
        key: ENC[AES256_GCM,data:G5IVPPZ4c+BHbjHcxcEL5cCxZbMWDp5Jn5nNTG3F5gOUoVqISL0U1Lz9BKDsao8sa4l4uVhaePN2ElVFUNrxTDHEkM5V827L3AYzT0utD5+i1hEiOlWYPUBb8q5IeKN6m6yJdNBbvqwhOVVeYYWIdZqfWjbLKCeapT5CeQiBT0yP8b9FPt5rGLOMqV+5+MrKeSxLzmIm3H/bCLQrX7T12uFB1jrGtkvOBHMveYBXFYNHlvUk78JmLx4H3CGULxn354RPgG5sd7JsNyuLeRJy8O1TdnPT1+rWdRgw9CIv9JMoBxb7X7Ec3djA97aoAbpZdDVVGxPQpI0GHD1sE1NQ7DlaVdxxMD3Bc/L8PexmRMgf8FG31lZZ6z3YyVjABvk3+p3axJ9ylv3GtHAHKHybtQ==,iv:el+PE0sjvBijwTuo2R92xHZWYC6Wkf2s72cCE8TiuaQ=,tag:1kMby/vnSCpk+3xlk5+KmQ==,type:str]
    #
    # =============================================================================================
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    # =============================================================================================
    aggregatorCA:
        crt: ENC[AES256_GCM,data:Vw2EFZeva9F2Nyw7t/1MLhn2IoNOEj8o+2SBTq9qQSrDN4z0c+mFn3kSs+t4V142OqX/gI433opkAMnoxeh3ywUypvv0W2fKlFL9uuhnDlHong9/OAIjHuok7WonBOtjZ7bqYCaoKV01FR8GSOm1aQjAjdqfKIAe13TCW5rHf+9Z8mpX1PDtu7ZZigvW64kiQPJ237MIwX6+gZBX6tk8tO3huUvspvXngf9OP2CLkmug+xBbYdxS4mV/TwkUw+4DQjMQKJA6uF8Z3XyvWUkNWQMe8CBMwAlgJl3WecKba2Wl4n+dXWLnGSLWDeI2ERVZ01vSo9g35sZ6blB+lGtv/EgONwsqml9CUWXgtRwRsO9Jv8JTJqZ4yYUbPY4QGxNRbEwfDfhymrj0AYsOHWrfvfXN0wKd+ieoi+rnx7ttUQNBTDkvtaHL61ASs9VZLJXXCbTNHuAaCg2St8J//+wvdTfHfVPhIV0AL0maG5OIab6OECxX0FSbqe6dDFQngMaX9psQ2JQ6efYJe9W1YtLhqaX38a0vRhixaJIiLOMnF8vT/GRCaZYAH8IMElR7hiogtxhaEtPKN/Xwhf7xl5YPKhc0KYvPIsEcRiCEfut9htdLq8RMS8lqUBcQ58hmf+qwNE/9OdCMY71fIRb+G/nv4UNdyivV+nDgz/Buiyrp5mv87h196OSUKgwmpz3qYvnIZ7pIbWYdRTXI5fiFg/pc2NvqkyNgTtSAoiNI4ox5IDezyZAji65tE/QDz6NB2xT6m3+xR6sWEnSvXwXe281SXIKWM8lz5eS77uL/WZOBQmmR0hFODwKVm+EYyMjXNqXfiQ/i5STwGJlyjPvGiQSKOAlBqnhFzxHF18KN1pQXtZyL7LHNAE1jXjbXX1qV0qj7SLE/O5lvqkj+lfUYu/uf8QDxsXEF6GWnv5S4/jVohuaoIQrSGz51JA==,iv:myM5yiukuoCPRBpDa3d9J9G9SZ96oXlbtgR8n3h/FlI=,tag:7udO7UH9OFRRYk4wITBVHw==,type:str]
        key: ENC[AES256_GCM,data:lZC1pUbhWap0ncPMP3DA+TcXyWyfWgEl/rxtGYrgYJzdScpGRfWNlnNx/3fCJHxVlPmBaxpxqvLNya3SIi5zMXwzsQKai5EGcJhIHAV3UqNqxvTzi92kO9yfR8bxIOxRkb45St16PeQduU8g9ombRq0hEDGBqGx95Q6R9SVKQ8TGWnZSpQ1G0J30RitYg4DSgQZot5sN1FJnlOS5+K5RVU6vFof5FV2fGYKRgc437/P0semxJnLF1TwjQXckMwXseqSW4cXeNGAqcGWgypTNy4VDnQqcfuqwuic2Ak2GtoRswQ2McKET9ER0dtjaZglhhQeit6VH53uzPCo/nSTy/ym6NjF0/vgaAUtsnXvYItEoOQQsZJtPNoTYtsM286UX4f1R1wEK1vlOt70bI92t1A==,iv:bs9YYZ03kSoEUTnbtqOl8z/00tGEbSqgj+TfMbh6O94=,tag:kylFRp9P/QA3u1eaYU45rg==,type:str]
    #
    # =============================================================================================
    # The base64 encoded private key for service account token generation.
    # =============================================================================================
    serviceAccount:
        key: ENC[AES256_GCM,data:UesdF0fwLuyauqUItKTj/FCpm7cQxbXG+n6bEZbgVWEAV6QWw7MUzG46OK8KKVPO3rvEzs0KjBS5W1DvnykX2MiBBg6BhDhTPEZ0znOZam8bMZaAsh2iooZ//tqNwBBuO6i2PiIHsaY58GoGrQbNQ/kTg/8/lwHiiFSgLsk6TwZpI0fvX3uPrhS2905WrZnvqj7c66ZfuDskTrcShM5rWi5N7ORsy4XXiwKoX3Zif7ewFn52/XLLV2ry8QA5yz31+MfvthQYZrEJ2JEwSXeBpTDJY6XvEELsrNB/4mUBVzdL3syfzP/fWV48ECXIRJt1xs2LZ2QK691s8aoyKH3MY1g552FrqSnAhtpGHaXYtpBV+dHxIsSl/aV5D7EHoyZkjHoLndq4t3tv2zeJQx/u0g==,iv:baKUI/ksmTzMd+qYMelpKy7DK6A8+CS4RAm5EK88eVk=,tag:XYhJy+tNG2I/imvBUZphtw==,type:str]
    #
    # =============================================================================================
    # API server specific configuration options.
    # =============================================================================================
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.28.0
        certSANs:
            - 10.0.20.10
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: restricted
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: restricted
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    #
    # =============================================================================================
    # Controller manager server specific configuration options.
    # =============================================================================================
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.28.0
    #
    # =============================================================================================
    # Kube-proxy server-specific configuration options
    # =============================================================================================
    proxy:
        image: registry.k8s.io/kube-proxy:v1.28.0
    #
    # =============================================================================================
    # Scheduler server specific configuration options.
    # =============================================================================================
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.28.0
    #
    # =============================================================================================
    # Configures cluster member discovery.
    # =============================================================================================
    discovery:
        enabled: true
        registries:
            kubernetes: {}
            service: {}
    #
    # =============================================================================================
    # Etcd specific configuration options.
    # =============================================================================================
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:MVJyqpnWOl68YRnbWwt36iYBAkZ6UiIUgSB3PwQ2PmUMN0nWAB8plz/+7zeEvQFLK4CHXp4u0pGpTPFutkanl7ghA7aUCOXbhtwmwp4upheSiPWC1HjMdS22X8HSARgsEddEbanyHtB2pCPgS84t34UrdZ72Zn269+jQh0FELQSxbjiYeLxtxgXnmdceKA4z2LeaFlwqt44Usoa6PTNPHKfvnGqV0SvBFNsoLPbExF8agtd44qgRMgsMWSQswD26gY8GMrr5sgyyGi9JNfEekpMH8dtd4Gy3YRyXqKELS++QQJAMV55lkYDNukm6ue2c/bjkr9fwXEpCRGzdpU7IdQa4N8QOdcFBGMxdVKYLVcwFAoHGRlht2Z/klVM8jTk48J+P+o79yMlVvjMxnF0y0DlE1KQx774d/wtk8gaeUoArZDebch9rYpjS9GGYVdfjgWlGF/XADVlRvwFv9GViW7Mju46/vUTTzLF4zUMf7s4a98Lh+2/VZpnWWfzjawS+n/qc/fx1xd8qEeMkE907kpdUEHwc9FBVQzpy7drhQthPYtxBaMRVpOw/nNaHTCGGYi3NejuJHBsW4+iJ8uaoMdyPJ18WBxKqpOSNElHxG3QWrIsITM/V2Y4Dns81FrzzsO8ePfa8pvhtf5ptRK6AbzPTCjdBwrvOoCY4XezaiVorFaNSjFv0L6PnLwS9HA7n6mTeiJHCPINQBvdW2cNwhcTuP5xfnsgbd1T036IdNXBpYTPRay8S60nSlzr4Ou2VpGP9Cnn8kjGJiS2e8trqUkmBMMFZ8rujGV8nQYbD0DNwZRzGlw8B8DyEYREYi7w5kGwOE5/ZhytlZMafM72SqOolwdBvU6kb97iQnyJNEmHEruYj58JlzpIcanhWVIXgFzBBMRIlpWtBqVpz73Apzdjem0XHovwXNTAut7zkAV5YpjMzIyjrTAl4izSSRGhHwZ7Uhg2V7vB65GenLj/Wj1tAgNMWwqS+g53RMI0YTS8guDJueoEklXU3Nz49V9GAmU+x2A==,iv:jGkOphNmf5Pe6sKOgUbV8g5/NxCf8znVPLWFEyWEBWA=,tag:M7qrqwjbEAws3NSXvShzoQ==,type:str]
            key: ENC[AES256_GCM,data:+wh+ud1XhxUJK1xQrquhHPNYKi8ysPX2eXZyWjDylWNfU7maPlrcXeaeDJhqPZ74JOF5CknB1qsCLbEC8zjsAEZgYPj0x+Sbp05aHIwnMdBkz3N21B/gKXsR05UjI0sDhkYLIiE/950wkMjKNuaw9v9PAOMfnyyCR8jzxT7RCkiBCtNHfAannZRvjM9bBtwF8uzTHIZIdJ9goxCRzYEjzm2pYfUXqsgXFtgfObKUU1TSVIENRY8Gf9j/CF8K82YRq0mcsQ/Fz548C+llycYUt0NPP6tPcaM5CldiVj2zW7psQNrM8Qmkqdyio8oVFCp01GWuRJYzZp5362ZAcOkp9A2eiKp96x0Cnalrl/Mzd7Jlkj4kSSyhRfwaTmN4AFOUr1Ik93SU31yqLllHChQI7Q==,iv:qWAIfp761d0sRCu5BxBWyYDjFwfiAuu+sZ71Mv+iWD0=,tag:StQLH01esw9dDlpcQRYA8A==,type:str]
    #
    # =============================================================================================
    # Core DNS specific configuration options.
    # =============================================================================================
    coreDNS:
        image: docker.io/coredns/coredns:1.10.1
    #
    # =============================================================================================
    # A list of urls that point to additional manifests.
    # =============================================================================================
    extraManifests: []
    #
    # =============================================================================================
    # A list of inline Kubernetes manifests.
    # =============================================================================================
    inlineManifests: []
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBKdm5TYTk4eGtEeVZzQ29H
            eWE5Ui9pWXc0eHFHelpVZ2VCb3pnVlNjUm1jCmpqeU1zcXZTeCtaR2hTSjBxaXQ2
            OWVpYVhIOGY3bU5xRlFsNVgybjlZTzAKLS0tIE0wTnpWZW81TFJmdUJaRUxncUdC
            TnRLbjRFa2crMHh1aFZ6dDA5dXdjZ2cKV0kXmKVABM28NZWZh9YAx4VpK1R08KC/
            887eiujFFxr/F5KmlfKlxFv99FObgKICZ+0U87wuug5QAAkslS8k2w==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-08-19T00:02:38Z"
    mac: ENC[AES256_GCM,data:9ioadDpFGD/OWo8nLxscK0AQdYnPWrk1+JNrikJfzFELWBmACd9yXhe0WAmiCdjFgR91am4B1fvwmaLDpweGA5n8LG33flVvfIcMKQitGSsarUIwf1cIxWGjJgq0JQhMmI8fnjjGxA4kyYCIiqY1ZwOMToMONUHOBVZ6o54q/Dk=,iv:8Itzdgp7CKEMzw0ISPt2wt+EvtbZNexxcXUJNoKAxRo=,tag:b4BmOkXATLoIHdIcCwyfSA==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
