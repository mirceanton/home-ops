version: v1alpha1
debug: false
persist: true
# Provides machine specific configuration options.
machine:
    # The `token` is used by a machine to join the PKI of the cluster.
    token: ENC[AES256_GCM,data:WZTwNfQ7GfCgF9vzxKrj8C+S6/Y9D64=,iv:R6vkahnN/aFRPsag8NZDLcej64h0QKbAg8h/6cY60Wk=,tag:404QNSkC06RzNLpGwOCOtg==,type:str]
    # The root certificate authority of the PKI.
    ca:
        crt: ENC[AES256_GCM,data:DTBJjPXwsOdGrDQGdRJAZa6nHY/Gzj9j9qmrR8uZVEF/I0NZkgR4cYmPyRqTCcmKBTlvp3k5DbZDLCWF+JDScQfo84l51wvLBt3+Nj35SL7VGjaraVetPzrsDj8S5lmryFfM6seD8SXAKVYwrGl7TRyS6j2OJ0wBk2wtIy3GH13Ll7ggKmz+h5fKIOGE59cPwOW9VyP2k4fwVjRtWnW2B56QzJIQlGE+5aeyUDjT0bmXnT4uv9hks0bS0F3HWyqpxkdUQZfUZucMzgnnQCV1t37DvfNcKfP8y3c6fM3FvcAVqnU3ZjrPSHIb0TbwcGvQBY92d/xmFPrAAzSzfkTPHeJZ944JhRyMlPmUo6wisFhqV3Gx0oVxqG8v88Ja678KBfMtGS5QfL5AJopJVbjhTCBn73PJmPcmkqqjfoxTm5wR5LTmCQm4RRPhcRKKsnjfbmZcuc9Z3bvRJ/TDQBttEU7prVAHsgxqqNDigHBzHX0WOjl+Y+0jGqK/5M04sFetCmiMT1be54ZG7YHOzuMGpLCJuvttlALa04Bs4xzKFGNepezCcAFygkIn0jeTqCrIMY0lmxckd+3BC5PNhb6gdoBCZvMvrDb/DV+Vofr0gBPDto/i+kPV/MV7aml6mNho4HV8bneUEEd32pKmAo1uoKETJFE+1PN6QS36rlwu1bsWqrtQKnRbil/yjYcCcODRSaZe5aGQAqeLx0i7TRzB4n8MjekuighfzD9xPEDvIx5uZtA8XbZIEVenitXfMGxAAireKuUOWhZIForaH+VGkbPj+4xELpGvD9naK3wQXM2TAVz8sIMrt0xI5Bh9Rb1gRHJVPY6N2uXRXKu32yUtRAsaJo1N//lITP4HFCavH/uhRmsD,iv:O2i9bXZ+ZH7j8b3BwHaOAN7Iif0iKQB2W7tOuvZcbqM=,tag:+ZEio3Sf4ef3RMvJmVajoA==,type:str]
        key: ENC[AES256_GCM,data:HagEpoqxhbBVTRV3XQw4xGZoRCNC7suxw03R/pylTkktz285YIjJmWdqu0JeLmNdzzvPu6AQu4x3QkZ8UFssnJYdvs9fd9hY8IjmsJLlzBxGTwYOBCKlz789L3bUlQCuntuJuXsdlqlIQ8CJJoqzvBoIJKRJ4CXfxFnDTlbqEqoNKyRivUmy2+l00pXVEQyJ4qFswMQDhRUZFfSHdQ1BV9HhE/WQq4urzc4SXckSdstWmNfK,iv:o1YIVfaiPxdIkI8MVOz9UJvjMOyO5bQjlOGGp6Ot0QQ=,tag:33+Cdf83NoDOsGuE5/4aRQ==,type:str]
    # Extra certificate subject alternative names for the machine's certificate.
    certSANs: []
    # Used to provide additional options to the kubelet.
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.27.1
        defaultRuntimeSeccompProfileEnabled: true
        # The `disableManifestsDirectory` field configures the kubelet to get static pod manifests from the /etc/kubernetes/manifests directory.
        disableManifestsDirectory: true
    # Provides machine specific network configuration options.
    network:
        interfaces:
            - interface: eth0
              routes:
                - network: 0.0.0.0/0
                  gateway: 172.16.42.58
        # Used to statically set the nameservers for the machine.
        nameservers:
            - 172.16.42.58
    # Used to provide instructions for installations.
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.4.5
        # Indicates if a bootloader should be installed.
        bootloader: true
        # Indicates if the installation disk should be wiped at installation time.
        wipe: false
    # Allows the addition of user specified files.
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    # Used to configure the machine's time settings.
    time:
        disabled: false
        servers:
            - time.cloudflare.com
    # Features describe individual Talos features that can be switched on or off.
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
# Provides cluster specific configuration options.
cluster:
    clusterName: production-cluster
    allowSchedulingOnControlPlanes: true
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    id: ENC[AES256_GCM,data:ZZOn0B77a0+h6nvBQN/75Kf+cOkFGxjx/xkp+CThC2iAh/TzoIiFl3ppeA8=,iv:d8+0JPP/+q3ClxP9lPuvsRyAWuCEDPFc4EehxTkOjcQ=,tag:T4ixFYy8gTX4IzhjJKb97w==,type:str]
    # Shared secret of cluster (base64 encoded random 32 bytes).
    secret: ENC[AES256_GCM,data:uFL/mNgdsNzvYLbiV6OSzwZv7ug0N+MjP/rjfmde6V1Il1ZeNzTAjqIYObM=,iv:YjiECJAJjfDNHc6ewtdjKcdToe077vMkQXEk1SvWZq4=,tag:F9RR5l7nwvampDBgDQqZ7A==,type:str]
    # Provides control plane specific configuration options.
    controlPlane:
        endpoint: https://172.16.42.30:6443
    # Provides cluster specific network configuration options.
    network:
        dnsDomain: cluster.local
        # The pod subnet CIDR.
        podSubnets:
            - 10.244.0.0/16
        # The service subnet CIDR.
        serviceSubnets:
            - 10.96.0.0/12
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.25.1/manifests/calico.yaml
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    token: ENC[AES256_GCM,data:ZAKqHy6OzudE2ZZSzXPHN3z1ABwV7aE=,iv:kZRHZtI9Kb9T7FFC5z6ExAKsiISL4tubVC3DlkdZS/s=,tag:daFQGjpqAR3Xc76lMIrq9g==,type:str]
    # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).
    secretboxEncryptionSecret: 2o/L7vgS9Trb7qrPXGJkY6hYkaaRPuIuS6vpVtrbFh0=
    # The base64 encoded root certificate authority used by Kubernetes.
    ca:
        crt: ENC[AES256_GCM,data:L4Pqnnoa+HXQ6cvfj0VGUx9OpCSAHGb4BZsx7jX/n4DfpjgJy/7Nnrnt85lHV+ZIBfnenIOF11z4TXmUNJbqNEAsZDap5cQ0WMRzbMpHgtl/BZOab6zNAjW7Zb4Rcbi0y4+HJgGDohAZv4wuVWVUP2HqSIsu38BXKYF6EOhedEFvKMtQZw4lkHmDBAVN+Ie4nVlycRF3Rg6F33bGqvox9LbMcT+FYI75TRLQFfxTuDolkxaIy8daK81t/BWoNlNkQDMMMPsM9tUG3iKkrGkU4lCwygo5H9+8sOJINJcOUjosMHnI7L4v8UHVItcYEVnDlougM9ujM8thsrsPetKau1vf/155EsvIvlSjVtmbKNZA6vhtF0aCvT0iLVtfztFYGy9oD0sfEf/lBgExsK5qBJDzLSG5ypXjn4HPUeXzlV8Xi3ow51o7zkKjzw6VHw6eI5clmnrI+Q31fI+pZ6ErNht4eFW3GJ0vRsLVZEm+jYQYDUSZASVixfU0L1XdALdF/cYz93SWGoSObkA6tECXWvqTLW90NF+Z2mc3ONztWqknSL3PRPKj5BoXIl5Pi2MU/Ymj3NLxiPILMH1V+6yKi00W5gZQGJwuS1l0K/qPibsCaW1xHIWDQ1xlqJAENJJa6o2K8rdzaC4HyyBq0CG6vBMrOYhWR3H9QSkv6E96rKNQOm45J93zdqaGn8Xjg+nEXN7Sz9p6JFsOakzKQ8YS8t5soO6JJJwIeeHXWOZJtVgB8gSt2/+txcvDD6hbuoetB4P+hskUs/xvPKuoVk3TmHSa2WPEEBG5k7qlnNNWCZKtitNoTHJSmM5ERYv0QXMe8DAj0Q5yDOuXm9ThPy9yyIlt5aOExL2U59Lw3riqsyhdWHSuvQtrxUinqUpHPgJ7YdE2RQS1VizVEgEX23DEEQ2G0dMXbTJbj3RIRYqxdNzhvK6V6X4PKhvqpvEmQgz78eURFREuhflQQ3TH+YRIc+2AgMn/W0WKx8bKMmXHtl2e/3T+fN9DpYQabxI2UxssqH3aG88MCJqlDvwVmuJWMHLzukkiCjygzFblqQ==,iv:MwG2kv8eXZIXx5QWh+XVrV/2b68vuS9jrtL6LQN0iJI=,tag:5/HeIZVnIxMAt4atofok2g==,type:str]
        key: ENC[AES256_GCM,data:QW8zo+HvDk8vNcSCDWUxVOI6feIAFtCqS5FnwDzXpeMByhCU+WXfkCKTHTkVYyB9BkSooXoLun1GNut6eY3Hu3TwVO+6eF/RXXdQV4QhP4gtjJWpaqpyc2PgxlI6FUacmLa76xyjhFPVJyA8xkK/AvAxJSAPPz1ja02Jwpniey8coDKzOZ+HaDnTRDsMW+7UFZeyeX/ugpR+KFVkvADjO+UeaULHlYhLZLU6RpwqOVS41KxHTIzXi8QiLR68xrQvisk6SyWP6vFOA//jvNPQ0915RWbTkcA+rpjoXHkIGrOS2InZjyzPOONjlbITobmWLle14Cin13NJPsS7xvJ+HsuT47wGgbzb5GeXa10zWn0dkV/Rl8vbtEYPZkERRm9cx3ksibY/A/znN0uCi1Rg2Q==,iv:+sQtRliLgltF2ENJNbN0NnBM81eV1q+tcCy/AiFPAL8=,tag:dRy4LGy+8S2QbyL0qt/B9w==,type:str]
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    aggregatorCA:
        crt: ENC[AES256_GCM,data:7RMYBOPyWjL8GBjzPYZAObEsCXdYBlzlkjshcyzJgoeE0TJf/LtjRg29KdI5GDI9QzZu8XgOu9ETJzPU/3e8ofKGcm/LhYILCHJOyLLHT3DkCRhTMuDWVLI11hXFK5dFoKPzyEDqlfpZ7EqrQ+VLskyWTpSKhRbJ14c5vWuJbP80hXVnWoMgLDYFb4FjZGsMZb1pOGMJ1zBQe5Bp3xDPDP4Ts4PdSpSG+KCMRR714vzqeNlh2xV9imgX6+SG+9khvqsqHJO9btfxTEvF+wRy1gK6EB/Xs/GZ8bH7yK3omLRVrE9mnItmPwSFUI+Tkwv+tTcqAN1bPPvF8kF20J+nzvT+ezz7yrmTtQYZ/hNlKR9SqeKA7SH0OKbxeAcxlcrYL1u3zJNOZsQmyCi8LWn/UqHcnx++BWjk/3vOptDLMIWsTWTsW3SdzHHgU/8j+48svA2xqhGVmuC9k8Pf5CvdCyw0ipO5D05q4CXqVuWzrRwqRj3drC6KpKLzufFSlzOhq/wbEGCyruq0jktwJRZ1hPHjhMM8tWkWdS6WILcj+VvCnsdkMQKYAsAVAYjOpeVjJSUG4TUjQRigi0Y7c7IPb2ZfIjBgEIj+74mO64rDlSW6ZPG7yEqmTgMSTyji0LdX+4meiC+CnmwN+xEiY/PN0cnr2igKXOw6nF8TLQ3/TB8ChiGkX/JmEkmrhzFE4OjN3LMh4K7logsUCZxQOF9b0eEp1cfNgERLNuxO80Z4zqivDGDL5gcLZAslBc6PMnA5RlI8FJuEQcR5ggE+21U15T2BWFU7kqnf+UxYK9SvfkLMJGMbqnOH6ayVKJsECIPUKy3m5q0Buq39PKvmIpYyxlPT1iMLGGP0DxQeTo29926SPkC9A09dqcNw6fCLtzxZ4TBT7IwbOWk20Qixl9q0O2GJQYl4KVsILOISGECGYSfKvzOwqzlXyUODcZTdgP/1,iv:jeWLXTtPkAc/4vQI7H3Z4JrEQrJMRyFx0WGIqTp2Hc4=,tag:ZCsnvpqSFEAPwPu00JQPkA==,type:str]
        key: ENC[AES256_GCM,data:hn9tGS25zYfG6a5WHFfNh9n8AMRoVeN5Njjm3CfdaOD9hIZeFKEda6xCl8e7Q/8XWpseRjSlWQRrKLA1hcJMzNz6DfkhM/2arUx0YM9UEjCBvGLHBOkV2eNXx0Xy2or9jHdH5ngiz1C+xb7TLciQiaavCRAZ8+smNHxIzsjG3lBq7+TSukgfcOfei5/1DBdgXgmTgc+UNEV993cJS+MR0p1w7i0qRsoj1K2prOUVzfNjLCggFY0F7VgcyjlKaz5sZJdXMiFL0ii4DcGyuZuI3pEtarhA8i6THffV5FgwcYFQ8vBXOvMWWmDi6se5ox2BVEI8vOlyPRXUgSLFjgWwpvO8iSyy+yYYBl1nbceVMkWCHyJYTn0cJuSjisB8DYlWhHhF/EoQ2zh+wrGeRndxWw==,iv:ZeZzYeuhoOgNRS6ZGvm1Efhg1M0++A7Op7lrdoe/+xU=,tag:0mjhwxXpenzCkhv2hdglYQ==,type:str]
    # The base64 encoded private key for service account token generation.
    serviceAccount:
        key: ENC[AES256_GCM,data:5QzKjlcj611inN+pA6LuXB6GYeBcD81yn8oHqafbrEeXZZLTZmtV0aWxk3jdmFfWBJEHvjLto8la5e+kRm2n7o/6PKrKFMdjIzk6tR2yGbXV7K7iVLROeOynviR3Xdf+P+y3OxpdYyR2N9ekj/cLDlvThD6jVU2dqzadV0KqgHeLDqVkOqNaYil14FcjYwHocqUzyvaD0Twv1npAf48MNJZb5WQTKSJVcUB9sJ8GtnKWjkPx/EE1J6d/mpm+6jd2xcGsim7VSoZsGMrGkNJB3zvAZ9wyJayJLq5xjsahtcrVZRICnEwzZ+BtNwP7NXeiEPulKluafIsWvOTPBR170vxQL1/fjSuqp6gwmz5YxoGG0VtaG4yWHCIjeVcC43RLo5xNHU2paeBYIpqVwH4luA==,iv:dPy49jiH/gLyQzNW/0NEmG16dbROIO1TWZnYTqDyY+Y=,tag:rXifn9E4op89s0K8Yxb9QA==,type:str]
    # API server specific configuration options.
    apiServer:
        # The container image used in the API server manifest.
        image: registry.k8s.io/kube-apiserver:v1.27.1
        # Extra certificate subject alternative names for the API server's certificate.
        certSANs:
            - 172.16.42.30
        disablePodSecurityPolicy: true
        # Configure the API server admission plugins.
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: restricted
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: restricted
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        # Configure the API server audit policy.
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    # Controller manager server specific configuration options.
    controllerManager:
        # The container image used in the controller manager manifest.
        image: registry.k8s.io/kube-controller-manager:v1.27.1
    # Kube-proxy server-specific configuration options
    proxy:
        # The container image used in the kube-proxy manifest.
        image: registry.k8s.io/kube-proxy:v1.27.1
    # Scheduler server specific configuration options.
    scheduler:
        # The container image used in the scheduler manifest.
        image: registry.k8s.io/kube-scheduler:v1.27.1
    # Configures cluster member discovery.
    discovery:
        enabled: true
        # Configure registries used for cluster member discovery.
        registries:
            kubernetes:
                disabled: true
    # Etcd specific configuration options.
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:0HnaxgbUXApm3hfaZVwy869LMnLZo4lJhJ5ltAojNYUCRxL8QRKLSslYjjFImDTfqy2G7jqC7gBUWM90H73gSgk0Qm8/xLEL/38ftM7zQEJaW+nEG9Nw0mS49ahPuCEwtuZAwlmXhtNA7ii8giFVDF4tJRcj9k66XXUqKAiru9ap2f9riXxJa1oeE9oig5D8hUo4lWqBYNMrxHWn6GqsOqPWx19RWxpciS2OQh8cUgq99v7wn4cdCKkgEZ80DN3NMfYHZZuX+i1taqktNPy2oeGGyrkz9jnGL5WCKPlaFHeOphZfc09lxyh+tkGXffE82kXq0YabaqmzEDy4HZkex/rjVUq/nAQaEz64KZ4OHgck9iU+aTYas7cl/ImyYyrfjoY+qa2bAnWW/G52OyRt9UIHkc0KkQ+JcUoesUa+papykuo33zCxAFT6bJZIZePbgitpVl9sy6fKH1euyQNwrYRXPtP+dTDtcKIh9CywLxZ6ecVmJQqSJ2oOoMduk0MBUMNRzHVuVZUmy2DfxLgDfwciw8/bcedLnNrKXWNH9OhB5olGNhvkaWPOm1GdhVOzMBHYW4Y8yFArILomOY5YSDVoGfF7pcyrV+2tG6/Ia53/Tc3qxkUOTNOh3o+UsybCsUteLUsMUxGEQn38hhOINFBqO3DFVe8AwrAzZESLK6ubVcTKYyVy6dT76iCq96+uzbyfS9BJcYaY98xToEa6HyL1re6eCdQLhUGUoyahtxcS3B/PxL6CvjPryF9Co0EeSOV/Rw1Bscg6n9p6FBYOKv2Aj5YpcLfFQYKR/V2AlebdfLX7HugHsPKkHJTVRzcjDuwTqAKqoTWqntJRzgIfJRT17llYPYjatUtGt14UE1hFq8/nfYbI01bd+h5rlNA+DnRzC+FdreI5AsF1aSnnYdOVbOC0AzFNbFPRmKoX9qoz7q73ZNNn7JZG/AhZTH/tHZaIBG1jS/cVnBUJwBNqzqeePC6Q+7id23da7/jUNkIXUfZbofVAXIbCJCqOLGzf,iv:TJG8bemVRgS/NT97PdZho83cH8tFHdgx5kHhRaY9SiQ=,tag:UR01N5w/o6wQ6dpvTTdzrQ==,type:str]
            key: ENC[AES256_GCM,data:6KfMtZc0AB/FmbBhQyKufLiSkVmckELp2J1B7Cdy1gVidz/gDJCyFSN5/0K/51t4UOyP/1wD3/7ZiW61/wxK6FUO1MXqdnwSVzvSByjwwyNW7EeOv7xApTy3u6/ZYh0XOgR5wdmxrVTmYnDi69JizjV7ZWUTXwtFpABdygChugBRML0MdqGEhZeOZYlmKucy5MNG7k5JQMZYRc8SPQneNHc3r35TbsdRyLOrbdWGiniZlmkPgqgY/wS6Cf6lWr7ZGsbLrgTP8KJujpdye7OjfoX21OdzxFmHmSVKTauXqhvRR/rHTVxxXTKIuitCY/8zAgN+GbeJdfirMt9FnJHkGGf8OSc5QhPyhvWdpf0tp26gO8/LGI2JftbMod1uuE6dhK/7a6RivtblUekf+K3V4A==,iv:DyMre5y0Sw/6v626wSSmo47eVQoBam1ST4TvKrWz4wU=,tag:oHHB1OrfgJRq/n+mPjbvyA==,type:str]
    # A list of urls that point to additional manifests.
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
        - https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
    # A list of inline Kubernetes manifests.
    inlineManifests: []
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSA2MmpzTG1MOWcxM28zT053
            ZUVFWXhwTXh2cnRTcVV6WklHbWZETkNnLzFFCk5hOEFRTnpmSmlxQWxmV2tQMzds
            YWdsb3VLRUIvd0ttaE1JbVlwVk1McUUKLS0tIHpuTnlCREh4YlQ0VCtlWDlWdGI2
            N1dnTFIzY2RKcGdMZzZFT0d3WXVVQWMKA0xObjdmSdFimfl+M+cQu1CslQxP1Qqh
            SMwoiuC2x7DxYgH3nGEeP9sjt6Eh1Qt2b2TVy+2bT8Egy/IwA1R3oA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-06-18T14:58:57Z"
    mac: ENC[AES256_GCM,data:bzhynamp080Ul7pJu5+ZGS3NLK1T4XHr9Io03aLtx9jRnuXekfkJqBFettOwlmJIrzwmQpUq3qKkvbnkZoL3N0dTI0G8L5jCNuWMV2SzlPvafyxbQ1EK84hdsm67q8PJavoGA1HX0IG3M8lTxnbBMNDUDw209SWv4gjoF+4zYCQ=,iv:MhHAiuKcMGGZOLQIclHvpVd8xalP9Kw4aKPXu0KWvWI=,tag:8CJPx1U45AOLkdhRNDVQow==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
