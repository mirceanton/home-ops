# Indicates the schema used to decode the contents.
version: v1alpha1
# Enable verbose logging to the console.
debug: false
# Indicates whether to pull the machine config upon every boot.
persist: true
# Provides machine specific configuration options.
machine:
    # The `token` is used by a machine to join the PKI of the cluster.
    token: ENC[AES256_GCM,data:7VEXXE3YLgGBOEuq4cYP+IlhFHVk+ok=,iv:3P01wa2s55xYFusA9brN9+PUfjuEJ1e6lbOTiKTEqv0=,tag:Jaw+qXKd99ocPQ7FkObo4g==,type:str]
    # The root certificate authority of the PKI.
    ca:
        crt: ENC[AES256_GCM,data:XMZ+hnZ5tLMsrsVZk4HSv95P7/ZSdodRdLaKs6AEs13XroaBv8mLC4tH3ZpDtHdmMT0jGF12RRu+ffK8M1icRVY0kDPY0DX8sA7B3ZYUd310mK76tBszp2DbE+lMokB0a/sSrz/HR1C0dgASyW9RPS8mt2mZkmPG50e/n7jepM1X6jCJxfJ30KhUThB+2V1Zlbkjv+rWwzEB8fYcQYdjXgkNuFTWMpD9o+zwYVl6VWVVIdJBaq1ba/zU+B3QZEqu4sGDCa5fTGj46ViQBWJhpHYF4BHHBI1cdeDPBlVFf145rCgBdFGvgjkhPrUzN6lHZybngaKTiHLmzu3dEudetTktp3hFUZ8BX8CZtjqWBvxWrfvCbriz/lt6VLY2Mm3bRtWC1er3SkJZ7giBo1mRNTINmTOazXgIc9ArQXQAa3gD1xQwsscTiOmLNF2xZkN7tzZTxOW+521DNgfeqGcqarUL1S+awiHWfkAV1y4sMmE07k2v4ZJ8y20DrjHuSp+XukrjlZICO4kpUEUEE+6aqM5jCTwFl0HQ5IHblUUg+Ok/0MZCDZZnuddAvz4/V9PZNL/y8XrCZHQ0vcFArm1a0sKv6hNMGfYQ+nQs5wXgutU72A4NqfgZ4+zKT+3Qgb/oVuZor+3Yri/wbXtY8aq/M5AenNzmQeezb6ZgSL41SzVx5pJmcGs4MhqMUq8WiBmIUcEWuFkyZ6oE6WgtS1j3aL3qqGyDxbtdYTKIwekOd3ZbVHFx2eeTb+3aZAYls5Zd95GPhZCUKdwCI69qwCA4GV35D+8KLt+/5H6wWIU1/9t5geK2jRlxI0ZL8LZstxrPgNTeKXQWGfiWFdOKkCSYakNSD+uWwsPdSkzoi5MxyhWuwlyT,iv:vSYQFya219PuK0ogDZUlgJE00rfPOMCW+L9W+Rc6Hm4=,tag:Sk0aXX9+PHFf/B5NvYcdVg==,type:str]
        key: ENC[AES256_GCM,data:k1CjVPRFueiquwJzvRg8nJHShTUsOp/DjnEvFmQvKmbbt49eHzc17UWiA+7BiTvnTaptIaok9vU0iKUJNpWfIKgJ02lcQni5dfmCmJkBU+rNuO1Uy+GCZUA4JA5vvgY9cXCtEKbEs/y1FOUEX8NWZGqW+Y9z0p5DxIKtjI2C6TfwxmoQKSGK20YoO1vA1QAmuYM53zwtxad+HV/yBA1O9g7M7bQ4YRF2oStcEe77Tq/t/JFD,iv:lOnRVnRnt5zGXQj8dTdRMk1/pxBaDqarzO1LR/BXvJM=,tag:0LLbXzPSi8wS/Tvj1ibHQg==,type:str]
    # Extra certificate subject alternative names for the machine's certificate.
    certSANs: []
    # Used to provide additional options to the kubelet.
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.25.8
        defaultRuntimeSeccompProfileEnabled: false
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
        extraMounts:
            - destination: /var/local
              source: /var/local
              type: bind
              options:
                - rbind
                - rshared
                - rw
    # Provides machine specific network configuration options.
    network:
        interfaces:
            - interface: eth0
              routes:
                - network: 0.0.0.0/0
                  gateway: 10.0.10.1
        # Used to statically set the nameservers for the machine.
        nameservers:
            - 10.0.10.1
        # Allows for extra entries to be added to the `/etc/hosts` file
        extraHostEntries:
            - ip: 10.0.10.11
              aliases:
                - mkc-01
            - ip: 10.0.10.12
              aliases:
                - mkc-02
            - ip: 10.0.10.13
              aliases:
                - mkc-03
    # Used to provide instructions for installations.
    install:
        disk: /dev/sda
        image: ghcr.io/siderolabs/installer:v1.4.2
        # Indicates if a bootloader should be installed.
        bootloader: true
        # Indicates if the installation disk should be wiped at installation time.
        wipe: false
        # # Allows for supplying additional system extension images to install on top of base Talos image.
        # extensions:
        #     - image: ghcr.io/siderolabs/gvisor:20220117.0-v1.0.0 # System extension image.
    # Allows the addition of user specified files.
    files:
        - content: |
            [metrics]
            address = "0.0.0.0:11234"
          permissions: 0
          path: /var/cri/conf.d/metrics.toml
          op: create
    # Used to configure the machine's time settings.
    time:
        disabled: false
        servers:
            - time.cloudflare.com
    sysctls:
        vm.nr_hugepages: "1024"
    # Features describe individual Talos features that can be switched on or off.
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
# Provides cluster specific configuration options.
cluster:
    allowSchedulingOnControlPlanes: true
    clusterName: management-cluster
    # Globally unique identifier for this cluster (base64 encoded random 32 bytes).
    id: ENC[AES256_GCM,data:NJUoAvcjBsRcUED5yBEDSAfj6qihGUYxe5mnGfjLLLuxJlAmqnp4FwhLOeg=,iv:cE5Bk5keEp+DzMgO5bWcXJgs7QaIp1TPn5YktI4m7w4=,tag:CYSdZd1BgM9KfGNymNsovA==,type:str]
    # Shared secret of cluster (base64 encoded random 32 bytes).
    secret: ENC[AES256_GCM,data:KSf48MqxYvCnIMXe/X1LVagB1zes6CVDEbSl7Gck2rt83ucAxGrOe1wrEdk=,iv:CqhtcfXGlN85oNiaOYCMJOiCCpO/hK/vLCY4LUoNt7E=,tag:QXHQD6/p7EyeBYYilSxUvA==,type:str]
    # Provides control plane specific configuration options.
    controlPlane:
        # Endpoint is the canonical controlplane endpoint, which can be an IP address or a DNS hostname.
        endpoint: https://10.0.10.10:6443
    # Provides cluster specific network configuration options.
    network:
        cni:
            name: custom
            urls:
                - https://raw.githubusercontent.com/projectcalico/calico/v3.25.1/manifests/calico.yaml
        # The domain used by Kubernetes DNS.
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    # The [bootstrap token](https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/) used to join the cluster.
    token: ENC[AES256_GCM,data:rCeJ+ySZMtuRTiamCtqhAoL01lKkTLU=,iv:2C3gIoDa9CU9aK99PzTb2cjdHyYKp2EN6gIPA83fnks=,tag:rHkHwp/mqzB6u35OrEmmPA==,type:str]
    # A key used for the [encryption of secret data at rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/).
    secretboxEncryptionSecret: PZ09M5ZzWPWXxhCW1lpyIZI79tAS51zrtQFD6bUirUo=
    # The base64 encoded root certificate authority used by Kubernetes.
    ca:
        crt: ENC[AES256_GCM,data:uVC+mOy2DzrOQwQaULz45d2pY5IdSiteuANyFDDfVnpQIK0/3a/QeGizoBk+7FEGJOfjjgZtPnKaDTp/Pd3srVIb/aUrA5vVusehi7l7qGreIvNfYOIZNwguxPyWWqMu1RA2BuMCfNJtG0L/xRAh8eofk8qlPH4jJPCMApjb6PDM+C8WgPerZWB8Yz6NJZmznSszYK03pL+c8UlRWEWRruRzFMuagW4mWncnE5AMq22iX+CE/alLpbDnacHF1wYCjF3jwQ8iSCoj8kmdbogn3G5Ka93K9l400WRytJp0+xhf2etBOj0uprzNpIpMUbh0TKHoC92Yh4UzQoItj88FiWsayrO8iyB6bXDWrquDt3P6uAJoA11auF8hqZolhqRQE9WOtbNpRKNz0izGeVe3oYs7kuMQZz4SVaDO7dNb/3fjTL6po7WLNtkdGWDdme2BkDlVcq7cHKzyuobIU4XEYlNfjdVLd5VRJXGWz/W7Jcpb+pfYt4IYPRvBaSbF0OQITXTKp/mOrCkCqb08vpem/z98hl62jb/JoqJlqTSgMNs2GLKzmUU6IBlpdYh98ZjA+kXmGqPQdRQxQebphljbo03x0Glx+pPdsIlZ3eoAzu++ZEGOLvyVzbmKHYEqEsCvtuN/ukM7COPG/i+nHBeOF1wfzCf9ggfSHbzUofBCfwmjVQ81/LdfhaxuW7+j1D0zavXFO/BuikMb7+Q4PO+ftIgkQj8CTT5Es2KJZsQTAV7jCp46TlFPUfZweCIKB2NoLzCjaX3s665XugZ+/6LEl3fjUXZLOkeZ+Eezl7gQZvxyA0kyYH9Sun0FYbAfAwKguk0KYbyba1PlJuDxxMD4eKxAPJiMbeP6gAR8kTiqC0Ihf36sh+QLj+TqtJAKVcNv9L/kc8pAr9JXkpn/8cZ5k+IAdeIScyJ16IUsXQR64DTCT2v1hs+A/ZMbMNFi0+s2lpEo5cx3EO+8yMGn4oIxpdI6yvN669KPFl9wHuv1b1c5/p2reR7g+D9qbnYCe884t82dtSJtPGFo++2CcckOC7aVP3PL02j+jCcIBw==,iv:Jnp0HdPLij1AGjTT0qsFnpesII3WlmrbbTKQ2cHgemw=,tag:QfT103gioDVkGQFsMJueaw==,type:str]
        key: ENC[AES256_GCM,data:nKSro3p+Pwe3QAZhIz1k0O7AqOsdtMgUh6O4UJGHkY4b5y3E+UQoVs3wPhnxSjuo4kcfr7+COE80XIdYCr/8InzpcJgn/ZPBuXrH6H71Yx4XplqHUA8i3tdvpnXGPrl+9v1TtdBmYiq4dBay31LUkUJldDxPyJTd/CJSCP3EjTeEk+7gN5UYCh71gVJj3O4de/7g+M74tf+ucIMBvoEYtG9ZC0kVNjvPMpA0TvA7T/3hnOwFun2DomTtuFRe9wFpN+pIxiM533rb4jWlK2facDg7cjrzZ6Wyjqsmu3qx7y5am+L4joxd3YEMUlqyHI51acqRL08S+Z2wKF1YUSyPhsMf7cHkztn9n7o30fi+hSqHcqlDoDdHqS+22JpfvyL9iUWhdWHai8Et5DJDKDJYPw==,iv:Jj9E3tegdh4OrtHysUU73Wqs6sHY77AChdys85jaiDA=,tag:5s72+cot487m0PBl0hIa/w==,type:str]
    # The base64 encoded aggregator certificate authority used by Kubernetes for front-proxy certificate generation.
    aggregatorCA:
        crt: ENC[AES256_GCM,data:ElPgCJcJnfLQdOKfqBwfdlWk7uxiCQ1w8qtSFnDo7VC0MDwrctjGtQD3ug60jgrlC5P5YHGRnjUwOunLR+9jpF3PtVGL6tzri0E6cxdcObVYjiXPDr6DRgPH4nsu0rxya8iSAsRqsS1BmX3BhfzThLpX2xAyfGy7dRJxyfPGrzNTx/jp/X+w9m/HPoCdwiTf1ZkiM8GtXw9CNfCp3h0TOzuF5rhGcWmAXX4GJ4xLJDgAvVRSe2aBoEaH+UvZlIHPaAUabyb0TS9aiYJHTkPZFBVGLnuAYwdARJUE6cYTJIZ2tHhrmK4OQiQNzGjUe+yQmVJ9IjfGhri0U5ISpaZ0DOis6HdyVe+bhg6nyCi5/rkiS87mB823xhfW+o9aj19G4Tjzf8gQfxcSYxeqGSu+s2UvtV4AMbPKMbDtfCE1H0+DNd72Mj1SBZ6umpgyvVC51Zwp6mctZEturZPL/59HwUIeNRdTlb41mPMaqYTMpoLATwb+w5jzR3OqqTNRkc/lvhUvP2b+NbrzHw9M7SMKdo5ve29ygzD90uiAHFaimI38lkS8l78g9GKhJsTIrYUWnF0/YRL7TBo55HqcEpxouY79WlL0MbCSiCWnURPQSpY8yRpIAaY6MDz4c3cza/rdvGjyFBW6bGLOJfHqpFwTAGKP0JoLDl9Bzj7q3tVhG8ELZEPzMuDlON63MjJB28Y9O54gvCsVyKxKfyerT2S4crU2RSgx/zLvm7MZkbpIn2jmmRZiJnKGtp9eFrAaGv34bVocMe/xsmqrOiRqbwdslc2/QCHFPwpSYiVDiTM7ZEZdHc85+xXOD6PMbTmDrcgeTGuPonY9ryKuChcgfAlDttucrSp+GNffzODKb/8chmPWetbbxYHQqEmiMb75p5isQdmTgeRV5TgKoUS4+DzmM+WsbjBSa3DZMD8VN+AVH/N3Nzq7OmXSwqdUekpWJcy8,iv:dcHl+o/TKAhn+mGQL6dkUG5a879/B8z0bw4zQ8wPSPE=,tag:0Yfe7LqIV0rmr+K1EqBIZg==,type:str]
        key: ENC[AES256_GCM,data:J9kuorHCFvqvO6T7AOepRVkT78KR/onmpHmzejWBUFaQZg4GBvQYM5xt8C4doGQYOfFuNTehQgrqyhhI3vDayy+Wy7OC5JARJz4vbSKsR/WtLcn/uaE7RLRIzuosHja1Lbyo6tfhNGvJmfxQ2zLWyFAhthWwYomQznE0+K5SvIxafOGANLBduJ2S6CE3HvIa2cpoKPN2AF6yf3oEdJ6oO1biPcXCc5WQRAHS6e/ZSY1+MTCmcSUXESg1sY97QstFRH7XDm5i4ndcQrN1dbtSknQmOtA4afuR700wH8XhulBPj+pplrEDE1yLIOASERba2HraXNcgeV0GE5DtlGUz1BcY3XTGoV+AbmsNCX4JO+Ywq1hEe8RgC+CCOS2A+81vbXki5yi2xGsigXl8CsZZ1Q==,iv:OFRSvZ6N8LHrGpB7Tjk0MzzTVitAVNVKqte1GDImNUM=,tag:vBxDtz4ZdL9Pp7/kY3jUzg==,type:str]
    # The base64 encoded private key for service account token generation.
    serviceAccount:
        key: ENC[AES256_GCM,data:xaJgSQs+izycv7EYkZmR2+GNHdozI+GqDqQ+geEXjIjVSIq9joLr+rWMhd6ts2KlslB9sRza45RhlCgVUQE4mmLNyqKVjUQVIYrwEfKNZgBVMh8xkT2qVj7ahptA9/n8hm2mEp0Fyd2f6kEzWrA68C1UGMKuIqqtHeEY5bZKMClzxP250HWEoFHFKck+PUZhBLyAdEcob5KYdC4v1FKLRbq5nyz+ROtU0E1po696kPezMh3NnJolUsWqamyy7ubHsZUM/EpaqJvQDEzJudN7WiDQJNkJnVk4WOq+DzEl6GdrPl3/AvQ80Fh0WOuy/dkam2Atxwk0s6fJd/ufFWhz4HRYktgS6NScYpmBShwqZhGwNHSE9ra7RNfARRuAy6XzRmOXJIu6e+npDHPaLUsZnw==,iv:4EDa5qYYtVWKM+HeQDd0b151B7Tl36tuB1CmeQmQjqI=,tag:X8n4cojnaLpxpJ2Ipd0dGQ==,type:str]
    # API server specific configuration options.
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.25.8
        certSANs:
            - 10.0.10.10
        disablePodSecurityPolicy: true
        admissionControl: []
        auditPolicy: {}
    # Controller manager server specific configuration options.
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.25.8
    # Kube-proxy server-specific configuration options
    proxy:
        image: registry.k8s.io/kube-proxy:v1.25.8
    # Scheduler server specific configuration options.
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.25.8
    # Configures cluster member discovery.
    discovery:
        enabled: true
        # Configure registries used for cluster member discovery.
        registries:
            kubernetes:
                disabled: false
    # Etcd specific configuration options.
    etcd:
        image: gcr.io/etcd-development/etcd:v3.5.8
        # The `ca` is the root certificate authority of the PKI.
        ca:
            crt: ENC[AES256_GCM,data:x27n1Of+75ITUYa4KHyv7dJ/YNND/xfEFLyLXAF6QusxHZX4Bk9BSsN+4YcnWOevwf6Htt28n2UVZBek9gx60SBJEAeZfDfssF38JfMQ3BBRwYljFvGYfC4riNgmafOSbS+wSaQ272+napi9LzzYdac/0lc8yXzKK1MhyFlIRXCfva0UhvECOPQpJ6bHOc7Jjd+n2q9InjbTf80r6RJPORiWPNEt2hIh78I3NUs6xmGuKuEJPYCd750jREASY+uvmLk6alGlp4QnumhOCp97T+hMobjX3ChM5EvHP7HcijSBz2gg1i/x5Ukjorsrto58+D1k9A8tLtfC6X7+AM9jXJWWGdPk24IX2RObihMlNLSu6OJ6BPn6kp0zr+RsCogZOsa8bpbHsA3RJEHdB23EtLUdYeHLJqFtfikwOiHSHWt0965Du8ZgVU8kds2BPTPYZVnrJElQDMss9ugR5g98oqdKV9ewnuGMV2S3jevAyAvDkM6MSgB3gF2kv8yqKtBCwsJUg8sj/4my6tdW0H3aSx3/1OrP23ELAHi1F8f6WGw8EdiEPLf4A9I330f68yYdVmO4tfqEdFi5SweYAPRHKe5tQPFzfJwbejFcp9QGB5ws9wOelWXnQX7/ekGlAWSoVki+Qyqqcty92cJtcXNkHpQyy9OFfR39IV10KVdZO18Oy1ieyV9HB1OYIsExi//Wb2DIH6FhWe5xADL/UXQgwz9JcBXaTcf5xMjHItu+3j+eMphO4Ow19nYHRBtJPHOdHCiDJYNkBEXcC+aQK4y79S3ufHehr+Hw5/vDaKL6JZ3vstRgD/RQsEmyPVQ8Ys5seclri8dVf84CfzVYbhhbgt0siiMtLvaVjvT00NmDo1vTnBpnsY7cWjM72ft4vc1nZ2loWWzwnMNaBwdBr2Y6bVMyhVJ+g5IrmJnW0k7OgOYhepz7Th9/Fd7RpdzoM5fMAXI9xu3Q96t6KYXxHn6Q0jFaz9/JRfx9uqyT7cE7aqjuHVSQlR4N/dbh6spBjdh6Ht67ow==,iv:nZn7HSoMQBRIpMXSGRLa55ZlZEm2hG0OH+G80cjrbLo=,tag:3EQvwgSYKsddJfuY2dtC6Q==,type:str]
            key: ENC[AES256_GCM,data:5zYiXeLyCSqkse5YV1k1d7cbxN8bTgmQfkIF7aIo8JPg8HZD1wysOvNUqq/N+sf2wosyTu81BX0EijGlxGhmv88mmNyghaSRmek993WefsJrahl/6eXmQLotzC3ckoPnrYHYJYp2gKrvhdYEQr8IuHnibpcvYgvbeRIFCV63PlhOCF3T21nfiJl+w7KM6UONq3wBnNNvIwfuXgFGJjfo80EbnoDRzaPzUF/nPGtKLA2SZ1iA2fgbDtH3XUffa3WRaoCaaUlOq028QBNaN3T8GbDdur/Ui4EwIGm8dOw/p52v6iOkYxJfgdB08g5+LmNyy8Mu+XTICUGPljAntLjVAkM4wzYeAsFs6epa5eud0JhkisUA2CYSuMEMrhNOJhGt8TZ9ydM6BAif+DS0x2h1zg==,iv:uYxrVsFrXNmSHh5JJV/m4oxp7bw8xvrFxOW+ebelu+0=,tag:Uf3mGWmZtfgT/UJWdRbtLA==,type:str]
    # Core DNS specific configuration options.
    coreDNS:
        image: docker.io/coredns/coredns:1.10.1
    # A list of urls that point to additional manifests.
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
        - https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
    # A list of inline Kubernetes manifests.
    inlineManifests: []
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1z6la87sppenwcdcr7lqj8amf5e4x7dq9gzr739cwg5ve6vgj0d8s6cahdj
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB4WVF5RmxMRnB5R1Evc05G
            UHFFMThNVXVaa0paRzFmUHFtS2NwcnF0dUVzCm5ueTJERC9MbDgvS0djelJoNXg5
            clkwenRwemtsb21vMXdObjI5WXZuZEUKLS0tIElOUndKU0NwTFd0VnIvZC9kU1dZ
            VFdBcnBIOXVBdjNHLzgxTWI5ZGZVWlUKcI59ksVANHHuPWurecLXY6tz3Md3GUUW
            PKtqqk6q6CRQVDUb41xpN/PBa+gk0PZplRBxsNBZsxMpQQ8XlMAfww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-06-18T14:58:57Z"
    mac: ENC[AES256_GCM,data:LK3Wqrui+FVT/Z4CYi9V2S4I5Z6859n63w3JdZT+qGcSJjaqKLaL0tb25+hWKEwRwrkS0pf++A/Vn5k84X4Ax0Zizn8209eWyOS6DmFWp3l8vgCF9HHrKz5Yvwf7J2SPZFEBdhFQ8o2lW/B8WZ4gToiCc0EOTN9l0pi2dWTv7rQ=,iv:XA/4VKjPorocfsHrAh96vJ1I3qrB5N0WcTSfpZ7WLrg=,tag:V5rAvedbRXMsSVW7d+Pubw==,type:str]
    pgp: []
    encrypted_regex: ^(id|secret|bootstraptoken|secretboxencryptionsecret|token|ca|crt|key)$
    version: 3.7.3
