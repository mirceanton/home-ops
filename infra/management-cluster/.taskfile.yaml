---
version: 3

env:
  EDITOR: code --wait

tasks:
  sops:encrypt:
    cmds:
      - sops --encrypt base.yaml > base.sops.yaml
      - sops --encrypt secrets.yaml > secrets.sops.yaml
      - sops --encrypt talosconfig.yaml > talosconfig.sops.yaml
    silent: true

  sops:decrypt:
    cmds:
      - sops --decrypt base.sops.yaml > base.yaml
      - sops --decrypt secrets.sops.yaml > secrets.yaml
      - sops --decrypt talosconfig.sops.yaml > talosconfig.yaml
    silent: true

  edit:talosconfig:
    cmds:
      - sops talosconfig.sops.yaml

  edit:secrets:
    cmds:
      - sops secrets.sops.yaml

  edit:config:
    cmds:
      - sops base.sops.yaml
