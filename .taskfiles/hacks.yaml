---
version: '3'

tasks:
  delete-stuck-ns:
    desc: Delete all namespaces that are stuck in a terminating state.
    cmds:
      - bash {{.ROOT_DIR}}/scripts/delete-stuck-ns.sh

  list-docker-images:
    desc: Show a list of all of the docker images running in the cluster.
    cmds:
      - bash {{.ROOT_DIR}}/scripts/get-all-docker-images-running-in-cluster.sh

  get-kubedash-token:
    desc: Fetch and decode the Kubernetes dashboard token.
    silent: true
    vars:
      DASHBOARD_ADMIN_TOKEN:
        sh: |
          kubectl get secret dashboard-admin-sa-token \
            --namespace kube-system \
            -o jsonpath="{['data']['token']}" | base64 --decode
    cmds: [ 'echo "(kube dash) {{.DASHBOARD_ADMIN_TOKEN}}"' ]
